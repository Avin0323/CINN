
.. _program_listing_file__home_chunwei_project_cinn2_cinn_lang_compute.h:

Program Listing for File compute.h
==================================

|exhale_lsh| :ref:`Return to documentation for file <file__home_chunwei_project_cinn2_cinn_lang_compute.h>` (``/home/chunwei/project/cinn2/cinn/lang/compute.h``)

.. |exhale_lsh| unicode:: U+021B0 .. UPWARDS ARROW WITH TIP LEFTWARDS

.. code-block:: cpp

   #pragma once
   #include <functional>
   #include <string>
   #include <utility>
   #include <vector>
   
   #include "cinn/ir/ir.h"
   #include "cinn/ir/ir_operators.h"
   #include "cinn/lang/placeholder.h"
   #include "cinn/poly/schedule.h"
   
   namespace cinn {
   namespace lang {
   
   using compute_handler_t = std::function<Expr(const std::vector<Expr> &)>;
   
   // @{
   // The shape are constant integers.
   ir::Tensor Compute(const std::vector<Expr> &domain,
                      std::function<Expr()> fn,
                      const std::string &name        = "",
                      const std::vector<Expr> &shape = {});
   ir::Tensor Compute(const std::vector<Expr> &domain,
                      std::function<Expr(Expr)> fn,
                      const std::string &name        = "",
                      const std::vector<Expr> &shape = {});
   ir::Tensor Compute(const std::vector<Expr> &domain,
                      std::function<Expr(Expr, Expr)> fn,
                      const std::string &name        = "",
                      const std::vector<Expr> &shape = {});
   ir::Tensor Compute(const std::vector<Expr> &domain,
                      std::function<Expr(Expr, Expr, Expr)> fn,
                      const std::string &name        = "",
                      const std::vector<Expr> &shape = {});
   ir::Tensor Compute(const std::vector<Expr> &domain,
                      std::function<Expr(Expr, Expr, Expr, Expr)> fn,
                      const std::string &name        = "",
                      const std::vector<Expr> &shape = {});
   
   ir::Tensor Compute(const std::vector<Expr> &domain,
                      std::function<Expr(Expr, Expr, Expr, Expr, Expr)> fn,
                      const std::string &name        = "",
                      const std::vector<Expr> &shape = {});
   
   ir::Tensor Compute(const std::vector<Expr> &domain,
                      compute_handler_t fn,
                      const std::string &name        = "",
                      const std::vector<Expr> &shape = {});
   // @}
   
   struct ReturnType {
     Type type;
     std::vector<Expr> dims;
     std::string name;
   };
   
   std::vector<ir::Tensor> CallLowered(const std::string &target,
                                       const std::vector<Expr> &args,
                                       const std::vector<ReturnType> &return_types);
   
   Expr CallExtern(const std::string &target, const std::vector<Expr> &args);
   
   }  // namespace lang
   }  // namespace cinn
