
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Program Listing for File ir.cc &#8212; cinn 0.1-alpha documentation</title>
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/gallery.css" />
    <link rel="stylesheet" type="text/css" href="../_static/gallery-binder.css" />
    <link rel="stylesheet" type="text/css" href="../_static/gallery-dataframe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/collapsible-lists/css/tree_view.css" />
    <script id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/language_data.js"></script>
    <script src="../_static/collapsible-lists/js/CollapsibleLists.compressed.js"></script>
    <script src="../_static/collapsible-lists/js/apply-collapsible-lists.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
   
  <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <div class="section" id="program-listing-for-file-ir-cc">
<span id="program-listing-file-home-chunwei-project-cinn2-cinn-pybind-ir-cc"></span><h1>Program Listing for File ir.cc<a class="headerlink" href="#program-listing-for-file-ir-cc" title="Permalink to this headline">¶</a></h1>
<p>↰ <a class="reference internal" href="file__home_chunwei_project_cinn2_cinn_pybind_ir.cc.html#file-home-chunwei-project-cinn2-cinn-pybind-ir-cc"><span class="std std-ref">Return to documentation for file</span></a> (<code class="docutils literal notranslate"><span class="pre">/home/chunwei/project/cinn2/cinn/pybind/ir.cc</span></code>)</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="cp">#include</span> <span class="cpf">&quot;cinn/ir/ir.h&quot;</span><span class="cp"></span>

<span class="cp">#include</span> <span class="cpf">&lt;llvm/Support/FormatVariadic.h&gt;</span><span class="cp"></span>
<span class="cp">#include</span> <span class="cpf">&lt;pybind11/functional.h&gt;</span><span class="cp"></span>
<span class="cp">#include</span> <span class="cpf">&lt;pybind11/operators.h&gt;</span><span class="cp"></span>
<span class="cp">#include</span> <span class="cpf">&lt;pybind11/stl.h&gt;</span><span class="cp"></span>

<span class="cp">#include</span> <span class="cpf">&lt;string&gt;</span><span class="cp"></span>
<span class="cp">#include</span> <span class="cpf">&lt;type_traits&gt;</span><span class="cp"></span>

<span class="cp">#include</span> <span class="cpf">&quot;cinn/ir/ir_base.h&quot;</span><span class="cp"></span>
<span class="cp">#include</span> <span class="cpf">&quot;cinn/ir/ir_operators.h&quot;</span><span class="cp"></span>
<span class="cp">#include</span> <span class="cpf">&quot;cinn/ir/ir_printer.h&quot;</span><span class="cp"></span>
<span class="cp">#include</span> <span class="cpf">&quot;cinn/ir/ir_visitor.h&quot;</span><span class="cp"></span>
<span class="cp">#include</span> <span class="cpf">&quot;cinn/ir/lowered_func.h&quot;</span><span class="cp"></span>
<span class="cp">#include</span> <span class="cpf">&quot;cinn/ir/operation.h&quot;</span><span class="cp"></span>
<span class="cp">#include</span> <span class="cpf">&quot;cinn/ir/registry.h&quot;</span><span class="cp"></span>
<span class="cp">#include</span> <span class="cpf">&quot;cinn/ir/tensor.h&quot;</span><span class="cp"></span>
<span class="cp">#include</span> <span class="cpf">&quot;cinn/lang/packed_func.h&quot;</span><span class="cp"></span>
<span class="cp">#include</span> <span class="cpf">&quot;cinn/poly/stage.h&quot;</span><span class="cp"></span>
<span class="cp">#include</span> <span class="cpf">&quot;cinn/pybind/bind.h&quot;</span><span class="cp"></span>
<span class="cp">#include</span> <span class="cpf">&quot;cinn/pybind/bind_utils.h&quot;</span><span class="cp"></span>

<span class="k">namespace</span> <span class="n">py</span> <span class="o">=</span> <span class="n">pybind11</span><span class="p">;</span>

<span class="k">namespace</span> <span class="n">cinn</span><span class="o">::</span><span class="n">pybind</span> <span class="p">{</span>
<span class="k">using</span> <span class="n">ir</span><span class="o">::</span><span class="n">IrNode</span><span class="p">;</span>
<span class="k">using</span> <span class="n">ir</span><span class="o">::</span><span class="n">IrNodeRef</span><span class="p">;</span>
<span class="k">using</span> <span class="n">ir</span><span class="o">::</span><span class="n">IrNodeTy</span><span class="p">;</span>

<span class="c1">// lowered_func.h</span>
<span class="k">using</span> <span class="n">ir</span><span class="o">::</span><span class="n">Argument</span><span class="p">;</span>
<span class="k">using</span> <span class="n">ir</span><span class="o">::</span><span class="n">Expr</span><span class="p">;</span>
<span class="k">using</span> <span class="n">ir</span><span class="o">::</span><span class="n">LoweredFunc</span><span class="p">;</span>
<span class="k">using</span> <span class="n">ir</span><span class="o">::</span><span class="n">Var</span><span class="p">;</span>

<span class="k">namespace</span> <span class="p">{</span>
<span class="kt">void</span> <span class="n">BindLoweredFunc</span><span class="p">(</span><span class="n">py</span><span class="o">::</span><span class="n">module</span> <span class="o">*</span><span class="p">);</span>
<span class="kt">void</span> <span class="nf">BindNode</span><span class="p">(</span><span class="n">py</span><span class="o">::</span><span class="n">module</span> <span class="o">*</span><span class="p">);</span>
<span class="kt">void</span> <span class="nf">BindIrVisitor</span><span class="p">(</span><span class="n">py</span><span class="o">::</span><span class="n">module</span> <span class="o">*</span><span class="p">);</span>
<span class="kt">void</span> <span class="nf">BindIrIr</span><span class="p">(</span><span class="n">py</span><span class="o">::</span><span class="n">module</span> <span class="o">*</span><span class="p">);</span>
<span class="kt">void</span> <span class="nf">BindOperation</span><span class="p">(</span><span class="n">py</span><span class="o">::</span><span class="n">module</span> <span class="o">*</span><span class="p">);</span>
<span class="kt">void</span> <span class="nf">BindPackedFunc</span><span class="p">(</span><span class="n">py</span><span class="o">::</span><span class="n">module</span> <span class="o">*</span><span class="p">);</span>
<span class="kt">void</span> <span class="nf">BindRegistry</span><span class="p">(</span><span class="n">py</span><span class="o">::</span><span class="n">module</span> <span class="o">*</span><span class="p">);</span>

<span class="kt">void</span> <span class="nf">BindLoweredFunc</span><span class="p">(</span><span class="n">py</span><span class="o">::</span><span class="n">module</span> <span class="o">*</span><span class="n">m</span><span class="p">)</span> <span class="p">{</span>
  <span class="n">py</span><span class="o">::</span><span class="n">class_</span><span class="o">&lt;</span><span class="n">Argument</span><span class="o">&gt;</span> <span class="n">argument</span><span class="p">(</span><span class="o">*</span><span class="n">m</span><span class="p">,</span> <span class="s">&quot;Argument&quot;</span><span class="p">);</span>

  <span class="n">py</span><span class="o">::</span><span class="n">enum_</span><span class="o">&lt;</span><span class="n">Argument</span><span class="o">::</span><span class="n">IO</span><span class="o">&gt;</span> <span class="n">io</span><span class="p">(</span><span class="n">argument</span><span class="p">,</span> <span class="s">&quot;IO&quot;</span><span class="p">);</span>
  <span class="n">io</span><span class="p">.</span><span class="n">value</span><span class="p">(</span><span class="s">&quot;kInput&quot;</span><span class="p">,</span> <span class="n">Argument</span><span class="o">::</span><span class="n">IO</span><span class="o">::</span><span class="n">kInput</span><span class="p">).</span><span class="n">value</span><span class="p">(</span><span class="s">&quot;kOutput&quot;</span><span class="p">,</span> <span class="n">Argument</span><span class="o">::</span><span class="n">IO</span><span class="o">::</span><span class="n">kOutput</span><span class="p">);</span>

  <span class="n">argument</span><span class="p">.</span><span class="n">def</span><span class="p">(</span><span class="n">py</span><span class="o">::</span><span class="n">init</span><span class="o">&lt;</span><span class="k">const</span> <span class="n">ir</span><span class="o">::</span><span class="n">Buffer</span> <span class="o">&amp;</span><span class="p">,</span> <span class="n">Argument</span><span class="o">::</span><span class="n">IO</span><span class="o">&gt;</span><span class="p">(),</span> <span class="n">py</span><span class="o">::</span><span class="n">arg</span><span class="p">(</span><span class="s">&quot;buffer&quot;</span><span class="p">),</span> <span class="n">py</span><span class="o">::</span><span class="n">arg</span><span class="p">(</span><span class="s">&quot;io&quot;</span><span class="p">)</span> <span class="o">=</span> <span class="n">Argument</span><span class="o">::</span><span class="n">IO</span><span class="o">::</span><span class="n">kInput</span><span class="p">)</span>
      <span class="p">.</span><span class="n">def</span><span class="p">(</span><span class="n">py</span><span class="o">::</span><span class="n">init</span><span class="o">&lt;</span><span class="k">const</span> <span class="n">ir</span><span class="o">::</span><span class="n">Var</span> <span class="o">&amp;</span><span class="p">,</span> <span class="n">Argument</span><span class="o">::</span><span class="n">IO</span><span class="o">&gt;</span><span class="p">(),</span> <span class="n">py</span><span class="o">::</span><span class="n">arg</span><span class="p">(</span><span class="s">&quot;var&quot;</span><span class="p">),</span> <span class="n">py</span><span class="o">::</span><span class="n">arg</span><span class="p">(</span><span class="s">&quot;io&quot;</span><span class="p">)</span> <span class="o">=</span> <span class="n">Argument</span><span class="o">::</span><span class="n">IO</span><span class="o">::</span><span class="n">kInput</span><span class="p">)</span>
      <span class="p">.</span><span class="n">def</span><span class="p">(</span><span class="s">&quot;set_buffer&quot;</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">Argument</span><span class="o">::</span><span class="n">set_buffer</span><span class="p">)</span>
      <span class="p">.</span><span class="n">def</span><span class="p">(</span><span class="s">&quot;set_var&quot;</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">Argument</span><span class="o">::</span><span class="n">set_var</span><span class="p">)</span>
      <span class="p">.</span><span class="n">def</span><span class="p">(</span><span class="s">&quot;is_input&quot;</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">Argument</span><span class="o">::</span><span class="n">is_input</span><span class="p">)</span>
      <span class="p">.</span><span class="n">def</span><span class="p">(</span><span class="s">&quot;is_output&quot;</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">Argument</span><span class="o">::</span><span class="n">is_output</span><span class="p">)</span>
      <span class="p">.</span><span class="n">def</span><span class="p">(</span><span class="s">&quot;is_var&quot;</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">Argument</span><span class="o">::</span><span class="n">is_var</span><span class="p">)</span>
      <span class="p">.</span><span class="n">def</span><span class="p">(</span><span class="s">&quot;is_buffer&quot;</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">Argument</span><span class="o">::</span><span class="n">is_buffer</span><span class="p">)</span>
      <span class="p">.</span><span class="n">def</span><span class="p">(</span><span class="s">&quot;defined&quot;</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">Argument</span><span class="o">::</span><span class="n">defined</span><span class="p">)</span>
      <span class="p">.</span><span class="n">def</span><span class="p">(</span><span class="s">&quot;buffer_arg&quot;</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">Argument</span><span class="o">::</span><span class="n">buffer_arg</span><span class="p">)</span>
      <span class="p">.</span><span class="n">def</span><span class="p">(</span><span class="s">&quot;type&quot;</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">Argument</span><span class="o">::</span><span class="n">type</span><span class="p">)</span>
      <span class="p">.</span><span class="n">def</span><span class="p">(</span><span class="s">&quot;name&quot;</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">Argument</span><span class="o">::</span><span class="n">name</span><span class="p">)</span>
      <span class="p">.</span><span class="n">def</span><span class="p">(</span><span class="s">&quot;human_readable&quot;</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">Argument</span><span class="o">::</span><span class="n">human_readable</span><span class="p">);</span>

  <span class="n">py</span><span class="o">::</span><span class="n">class_</span><span class="o">&lt;</span><span class="n">LoweredFunc</span><span class="o">&gt;</span> <span class="n">lowered_func</span><span class="p">(</span><span class="o">*</span><span class="n">m</span><span class="p">,</span> <span class="s">&quot;LoweredFunc&quot;</span><span class="p">);</span>
  <span class="n">lowered_func</span><span class="p">.</span><span class="n">def</span><span class="p">(</span><span class="n">py</span><span class="o">::</span><span class="n">init</span><span class="o">&lt;&gt;</span><span class="p">())</span>
      <span class="p">.</span><span class="n">def</span><span class="p">(</span><span class="n">py</span><span class="o">::</span><span class="n">init</span><span class="o">&lt;</span><span class="n">IrNode</span> <span class="o">*&gt;</span><span class="p">())</span>
      <span class="p">.</span><span class="n">def</span><span class="p">(</span><span class="s">&quot;__str__&quot;</span><span class="p">,</span> <span class="p">[](</span><span class="k">const</span> <span class="n">ir</span><span class="o">::</span><span class="n">LoweredFunc</span> <span class="o">&amp;</span><span class="n">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">std</span><span class="o">::</span><span class="n">string</span> <span class="p">{</span> <span class="k">return</span> <span class="n">utils</span><span class="o">::</span><span class="n">GetStreamCnt</span><span class="p">(</span><span class="n">Expr</span><span class="p">(</span><span class="n">self</span><span class="p">));</span> <span class="p">})</span>
      <span class="p">.</span><span class="n">def</span><span class="p">(</span><span class="s">&quot;__repr__&quot;</span><span class="p">,</span> <span class="p">[](</span><span class="k">const</span> <span class="n">ir</span><span class="o">::</span><span class="n">LoweredFunc</span> <span class="o">&amp;</span><span class="n">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">std</span><span class="o">::</span><span class="n">string</span> <span class="p">{</span>
        <span class="k">return</span> <span class="n">llvm</span><span class="o">::</span><span class="n">formatv</span><span class="p">(</span><span class="s">&quot;&lt;LoweredFunc {0}&gt;&quot;</span><span class="p">,</span> <span class="n">self</span><span class="p">.</span><span class="n">get</span><span class="p">(),</span> <span class="n">self</span><span class="o">-&gt;</span><span class="n">name</span><span class="p">.</span><span class="n">c_str</span><span class="p">());</span>
      <span class="p">});</span>
<span class="p">}</span>

<span class="kt">void</span> <span class="nf">BindNode</span><span class="p">(</span><span class="n">py</span><span class="o">::</span><span class="n">module</span> <span class="o">*</span><span class="n">m</span><span class="p">)</span> <span class="p">{</span>
  <span class="c1">// enum class IrNodeTy</span>
  <span class="n">py</span><span class="o">::</span><span class="n">enum_</span><span class="o">&lt;</span><span class="n">ir</span><span class="o">::</span><span class="n">IrNodeTy</span><span class="o">&gt;</span> <span class="n">ir_node_ty</span><span class="p">(</span><span class="o">*</span><span class="n">m</span><span class="p">,</span> <span class="s">&quot;IrNodeTy&quot;</span><span class="p">);</span>
  <span class="n">ir_node_ty</span><span class="p">.</span><span class="n">value</span><span class="p">(</span><span class="s">&quot;kUnk&quot;</span><span class="p">,</span> <span class="n">ir</span><span class="o">::</span><span class="n">IrNodeTy</span><span class="o">::</span><span class="n">kUnk</span><span class="p">);</span>
<span class="cp">#define DECLARE_IR_NODE_TY(__ty) ir_node_ty.value(#__ty, ir::IrNodeTy::__ty);</span>
  <span class="n">NODETY_FORALL</span><span class="p">(</span><span class="n">DECLARE_IR_NODE_TY</span><span class="p">)</span>
<span class="cp">#undef DECLARE_IR_NODE_TY</span>

  <span class="c1">// class IrNode</span>
  <span class="n">py</span><span class="o">::</span><span class="n">class_</span><span class="o">&lt;</span><span class="n">ir</span><span class="o">::</span><span class="n">IrNode</span><span class="p">,</span> <span class="n">IrNodeWrapper</span> <span class="cm">/*, ObjectWrapper*/</span><span class="o">&gt;</span> <span class="n">ir_node</span><span class="p">(</span><span class="o">*</span><span class="n">m</span><span class="p">,</span> <span class="s">&quot;IrNode&quot;</span><span class="p">,</span> <span class="n">py</span><span class="o">::</span><span class="n">module_local</span><span class="p">());</span>
  <span class="n">ir_node</span><span class="p">.</span><span class="n">def</span><span class="p">(</span><span class="n">py</span><span class="o">::</span><span class="n">init</span><span class="o">&lt;&gt;</span><span class="p">())</span>
      <span class="p">.</span><span class="n">def</span><span class="p">(</span><span class="n">py</span><span class="o">::</span><span class="n">init</span><span class="o">&lt;</span><span class="n">ir</span><span class="o">::</span><span class="n">Type</span><span class="o">&gt;</span><span class="p">())</span>
      <span class="p">.</span><span class="n">def_readwrite</span><span class="p">(</span><span class="s">&quot;operands&quot;</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">ir</span><span class="o">::</span><span class="n">IrNode</span><span class="o">::</span><span class="n">operands</span><span class="p">)</span>
      <span class="p">.</span><span class="n">def</span><span class="p">(</span><span class="s">&quot;node_type&quot;</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">ir</span><span class="o">::</span><span class="n">IrNode</span><span class="o">::</span><span class="n">node_type</span><span class="p">)</span>
      <span class="p">.</span><span class="n">def</span><span class="p">(</span><span class="s">&quot;type&quot;</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">ir</span><span class="o">::</span><span class="n">IrNode</span><span class="o">::</span><span class="n">type</span><span class="p">)</span>
      <span class="p">.</span><span class="n">def</span><span class="p">(</span><span class="s">&quot;set_type&quot;</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">ir</span><span class="o">::</span><span class="n">IrNode</span><span class="o">::</span><span class="n">set_type</span><span class="p">)</span>
      <span class="p">.</span><span class="n">def</span><span class="p">(</span><span class="s">&quot;expr_fields_mutable&quot;</span><span class="p">,</span> <span class="n">py</span><span class="o">::</span><span class="n">overload_cast</span><span class="o">&lt;&gt;</span><span class="p">(</span><span class="o">&amp;</span><span class="n">ir</span><span class="o">::</span><span class="n">IrNode</span><span class="o">::</span><span class="n">expr_fields</span><span class="p">))</span>
      <span class="p">.</span><span class="n">def</span><span class="p">(</span><span class="s">&quot;expr_fields_const&quot;</span><span class="p">,</span> <span class="n">py</span><span class="o">::</span><span class="n">overload_cast</span><span class="o">&lt;&gt;</span><span class="p">(</span><span class="o">&amp;</span><span class="n">ir</span><span class="o">::</span><span class="n">IrNode</span><span class="o">::</span><span class="n">expr_fields</span><span class="p">,</span> <span class="n">py</span><span class="o">::</span><span class="n">const_</span><span class="p">))</span>
      <span class="p">.</span><span class="n">def</span><span class="p">(</span><span class="s">&quot;type_info&quot;</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">ir</span><span class="o">::</span><span class="n">IrNode</span><span class="o">::</span><span class="n">type_info</span><span class="p">);</span>

  <span class="c1">// class Shared&lt;IrNode&gt;</span>
  <span class="n">DefineShared</span><span class="o">&lt;</span><span class="n">IrNode</span><span class="o">&gt;</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="s">&quot;IrNode&quot;</span><span class="p">);</span>

  <span class="c1">// class IrNodeRef : public Shared&lt;IrNode&gt;</span>
  <span class="n">py</span><span class="o">::</span><span class="n">class_</span><span class="o">&lt;</span><span class="n">ir</span><span class="o">::</span><span class="n">IrNodeRef</span><span class="p">,</span> <span class="n">common</span><span class="o">::</span><span class="n">Shared</span><span class="o">&lt;</span><span class="n">IrNode</span><span class="o">&gt;&gt;</span> <span class="n">ir_node_ref</span><span class="p">(</span><span class="o">*</span><span class="n">m</span><span class="p">,</span> <span class="s">&quot;IrNodeRef&quot;</span><span class="p">);</span>
  <span class="n">ir_node_ref</span><span class="p">.</span><span class="n">def</span><span class="p">(</span><span class="n">py</span><span class="o">::</span><span class="n">init</span><span class="o">&lt;&gt;</span><span class="p">())</span>
      <span class="p">.</span><span class="n">def</span><span class="p">(</span><span class="n">py</span><span class="o">::</span><span class="n">init</span><span class="o">&lt;</span><span class="k">const</span> <span class="n">ir</span><span class="o">::</span><span class="n">IrNodeRef</span> <span class="o">&amp;&gt;</span><span class="p">())</span>
      <span class="p">.</span><span class="n">def</span><span class="p">(</span><span class="n">py</span><span class="o">::</span><span class="n">init</span><span class="o">&lt;</span><span class="n">ir</span><span class="o">::</span><span class="n">IrNode</span> <span class="o">*&gt;</span><span class="p">())</span>
      <span class="p">.</span><span class="n">def</span><span class="p">(</span><span class="s">&quot;node_type&quot;</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">ir</span><span class="o">::</span><span class="n">IrNodeRef</span><span class="o">::</span><span class="n">node_type</span><span class="p">);</span>

  <span class="c1">// struct IntImm : ExprNode&lt;IntImm&gt;</span>
  <span class="n">DefineExprNode</span><span class="o">&lt;</span><span class="n">ir</span><span class="o">::</span><span class="n">IntImm</span><span class="o">&gt;</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="s">&quot;IntImm&quot;</span><span class="p">);</span>
  <span class="n">py</span><span class="o">::</span><span class="n">class_</span><span class="o">&lt;</span><span class="n">ir</span><span class="o">::</span><span class="n">IntImm</span><span class="p">,</span> <span class="n">ir</span><span class="o">::</span><span class="n">ExprNode</span><span class="o">&lt;</span><span class="n">ir</span><span class="o">::</span><span class="n">IntImm</span><span class="o">&gt;&gt;</span> <span class="n">int_imm</span><span class="p">(</span><span class="o">*</span><span class="n">m</span><span class="p">,</span> <span class="s">&quot;IntImm&quot;</span><span class="p">);</span>
  <span class="n">int_imm</span><span class="p">.</span><span class="n">def_readwrite</span><span class="p">(</span><span class="s">&quot;value&quot;</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">ir</span><span class="o">::</span><span class="n">IntImm</span><span class="o">::</span><span class="n">value</span><span class="p">)</span>
      <span class="p">.</span><span class="n">def</span><span class="p">(</span><span class="n">py</span><span class="o">::</span><span class="n">init</span><span class="o">&lt;</span><span class="n">Type</span><span class="p">,</span> <span class="kt">int64_t</span><span class="o">&gt;</span><span class="p">())</span>
      <span class="p">.</span><span class="n">def</span><span class="p">(</span><span class="s">&quot;__str__&quot;</span><span class="p">,</span> <span class="p">[](</span><span class="k">const</span> <span class="n">ir</span><span class="o">::</span><span class="n">IntImm</span> <span class="o">&amp;</span><span class="n">self</span><span class="p">)</span> <span class="p">{</span> <span class="k">return</span> <span class="n">std</span><span class="o">::</span><span class="n">to_string</span><span class="p">(</span><span class="n">self</span><span class="p">.</span><span class="n">value</span><span class="p">);</span> <span class="p">})</span>
      <span class="p">.</span><span class="n">def</span><span class="p">(</span><span class="s">&quot;__repr__&quot;</span><span class="p">,</span>
           <span class="p">[](</span><span class="n">ir</span><span class="o">::</span><span class="n">IntImm</span> <span class="o">&amp;</span><span class="n">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">std</span><span class="o">::</span><span class="n">string</span> <span class="p">{</span> <span class="k">return</span> <span class="n">llvm</span><span class="o">::</span><span class="n">formatv</span><span class="p">(</span><span class="s">&quot;&lt;IntImm {0}&gt;&quot;</span><span class="p">,</span> <span class="n">self</span><span class="p">.</span><span class="n">self</span><span class="p">(),</span> <span class="n">self</span><span class="p">.</span><span class="n">value</span><span class="p">);</span> <span class="p">});</span>

  <span class="c1">// struct UIntImm : ExprNode&lt;UIntImm&gt;</span>
  <span class="n">DefineExprNode</span><span class="o">&lt;</span><span class="n">ir</span><span class="o">::</span><span class="n">UIntImm</span><span class="o">&gt;</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="s">&quot;UIntImm&quot;</span><span class="p">);</span>
  <span class="n">py</span><span class="o">::</span><span class="n">class_</span><span class="o">&lt;</span><span class="n">ir</span><span class="o">::</span><span class="n">UIntImm</span><span class="p">,</span> <span class="n">ir</span><span class="o">::</span><span class="n">ExprNode</span><span class="o">&lt;</span><span class="n">ir</span><span class="o">::</span><span class="n">UIntImm</span><span class="o">&gt;&gt;</span> <span class="n">uint_imm</span><span class="p">(</span><span class="o">*</span><span class="n">m</span><span class="p">,</span> <span class="s">&quot;UIntImm&quot;</span><span class="p">);</span>
  <span class="n">uint_imm</span><span class="p">.</span><span class="n">def_readwrite</span><span class="p">(</span><span class="s">&quot;value&quot;</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">ir</span><span class="o">::</span><span class="n">UIntImm</span><span class="o">::</span><span class="n">value</span><span class="p">).</span><span class="n">def</span><span class="p">(</span><span class="n">py</span><span class="o">::</span><span class="n">init</span><span class="o">&lt;</span><span class="n">Type</span><span class="p">,</span> <span class="kt">int64_t</span><span class="o">&gt;</span><span class="p">());</span>

  <span class="c1">// struct FloatImm : ExprNode&lt;FloatImm&gt;</span>
  <span class="n">DefineExprNode</span><span class="o">&lt;</span><span class="n">ir</span><span class="o">::</span><span class="n">FloatImm</span><span class="o">&gt;</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="s">&quot;FloatImm&quot;</span><span class="p">);</span>
  <span class="n">py</span><span class="o">::</span><span class="n">class_</span><span class="o">&lt;</span><span class="n">ir</span><span class="o">::</span><span class="n">FloatImm</span><span class="p">,</span> <span class="n">ir</span><span class="o">::</span><span class="n">ExprNode</span><span class="o">&lt;</span><span class="n">ir</span><span class="o">::</span><span class="n">FloatImm</span><span class="o">&gt;&gt;</span> <span class="n">float_imm</span><span class="p">(</span><span class="o">*</span><span class="n">m</span><span class="p">,</span> <span class="s">&quot;FloatImm&quot;</span><span class="p">);</span>
  <span class="n">float_imm</span><span class="p">.</span><span class="n">def_readwrite</span><span class="p">(</span><span class="s">&quot;value&quot;</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">ir</span><span class="o">::</span><span class="n">FloatImm</span><span class="o">::</span><span class="n">value</span><span class="p">).</span><span class="n">def</span><span class="p">(</span><span class="n">py</span><span class="o">::</span><span class="n">init</span><span class="o">&lt;</span><span class="n">Type</span><span class="p">,</span> <span class="kt">float</span><span class="o">&gt;</span><span class="p">());</span>

  <span class="c1">// struct StringImm : ExprNode&lt;StringImm&gt;</span>
  <span class="n">DefineExprNode</span><span class="o">&lt;</span><span class="n">ir</span><span class="o">::</span><span class="n">StringImm</span><span class="o">&gt;</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="s">&quot;StringImm&quot;</span><span class="p">);</span>
  <span class="n">py</span><span class="o">::</span><span class="n">class_</span><span class="o">&lt;</span><span class="n">ir</span><span class="o">::</span><span class="n">StringImm</span><span class="p">,</span> <span class="n">ir</span><span class="o">::</span><span class="n">ExprNode</span><span class="o">&lt;</span><span class="n">ir</span><span class="o">::</span><span class="n">StringImm</span><span class="o">&gt;&gt;</span> <span class="n">string_imm</span><span class="p">(</span><span class="o">*</span><span class="n">m</span><span class="p">,</span> <span class="s">&quot;StringImm&quot;</span><span class="p">);</span>
  <span class="n">string_imm</span><span class="p">.</span><span class="n">def_readwrite</span><span class="p">(</span><span class="s">&quot;value&quot;</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">ir</span><span class="o">::</span><span class="n">StringImm</span><span class="o">::</span><span class="n">value</span><span class="p">).</span><span class="n">def</span><span class="p">(</span><span class="n">py</span><span class="o">::</span><span class="n">init</span><span class="o">&lt;</span><span class="k">const</span> <span class="n">std</span><span class="o">::</span><span class="n">string</span> <span class="o">&amp;&gt;</span><span class="p">());</span>

  <span class="k">auto</span> <span class="n">expr</span>              <span class="o">=</span> <span class="n">py</span><span class="o">::</span><span class="n">class_</span><span class="o">&lt;</span><span class="n">ir</span><span class="o">::</span><span class="n">Expr</span><span class="p">,</span> <span class="n">ir</span><span class="o">::</span><span class="n">IrNodeRef</span><span class="o">&gt;</span><span class="p">(</span><span class="o">*</span><span class="n">m</span><span class="p">,</span> <span class="s">&quot;Expr&quot;</span><span class="p">);</span>
  <span class="k">auto</span> <span class="n">bind_constructors</span> <span class="o">=</span> <span class="p">[</span><span class="o">&amp;</span><span class="n">expr</span><span class="p">](</span><span class="k">auto</span> <span class="o">&amp;&amp;</span><span class="p">...</span> <span class="n">ts</span><span class="p">)</span> <span class="p">{</span> <span class="p">(</span><span class="n">expr</span><span class="p">.</span><span class="n">def</span><span class="p">(</span><span class="n">ts</span><span class="p">),</span> <span class="p">...);</span> <span class="p">};</span>

  <span class="n">bind_constructors</span><span class="p">(</span><span class="n">py</span><span class="o">::</span><span class="n">init</span><span class="o">&lt;</span><span class="n">ir</span><span class="o">::</span><span class="n">Expr</span> <span class="o">&amp;&gt;</span><span class="p">(),</span>
                    <span class="n">py</span><span class="o">::</span><span class="n">init</span><span class="o">&lt;</span><span class="n">ir</span><span class="o">::</span><span class="n">IrNode</span> <span class="o">*&gt;</span><span class="p">(),</span>
                    <span class="n">py</span><span class="o">::</span><span class="n">init</span><span class="o">&lt;</span><span class="k">const</span> <span class="n">ir</span><span class="o">::</span><span class="n">Var</span> <span class="o">&amp;&gt;</span><span class="p">(),</span>
                    <span class="n">py</span><span class="o">::</span><span class="n">init</span><span class="o">&lt;</span><span class="kt">int32_t</span><span class="o">&gt;</span><span class="p">(),</span>
                    <span class="n">py</span><span class="o">::</span><span class="n">init</span><span class="o">&lt;</span><span class="kt">uint32_t</span><span class="o">&gt;</span><span class="p">(),</span>
                    <span class="n">py</span><span class="o">::</span><span class="n">init</span><span class="o">&lt;</span><span class="kt">int64_t</span><span class="o">&gt;</span><span class="p">(),</span>
                    <span class="n">py</span><span class="o">::</span><span class="n">init</span><span class="o">&lt;</span><span class="kt">uint64_t</span><span class="o">&gt;</span><span class="p">(),</span>
                    <span class="n">py</span><span class="o">::</span><span class="n">init</span><span class="o">&lt;</span><span class="kt">float</span><span class="o">&gt;</span><span class="p">(),</span>
                    <span class="n">py</span><span class="o">::</span><span class="n">init</span><span class="o">&lt;</span><span class="kt">double</span><span class="o">&gt;</span><span class="p">(),</span>
                    <span class="n">py</span><span class="o">::</span><span class="n">init</span><span class="o">&lt;</span><span class="k">const</span> <span class="n">std</span><span class="o">::</span><span class="n">string</span> <span class="o">&amp;&gt;</span><span class="p">());</span>

  <span class="n">expr</span><span class="p">.</span><span class="n">def</span><span class="p">(</span><span class="s">&quot;as_int32&quot;</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">ir</span><span class="o">::</span><span class="n">Expr</span><span class="o">::</span><span class="n">as_int32</span><span class="p">)</span>
      <span class="p">.</span><span class="n">def</span><span class="p">(</span><span class="s">&quot;as_int64&quot;</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">ir</span><span class="o">::</span><span class="n">Expr</span><span class="o">::</span><span class="n">as_int64</span><span class="p">)</span>
      <span class="p">.</span><span class="n">def</span><span class="p">(</span><span class="s">&quot;as_float&quot;</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">ir</span><span class="o">::</span><span class="n">Expr</span><span class="o">::</span><span class="n">as_float</span><span class="p">)</span>
      <span class="p">.</span><span class="n">def</span><span class="p">(</span><span class="s">&quot;as_double&quot;</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">ir</span><span class="o">::</span><span class="n">Expr</span><span class="o">::</span><span class="n">as_double</span><span class="p">)</span>
      <span class="p">.</span><span class="n">def</span><span class="p">(</span><span class="s">&quot;int&quot;</span><span class="p">,</span> <span class="p">[](</span><span class="n">ir</span><span class="o">::</span><span class="n">Expr</span> <span class="o">&amp;</span><span class="n">self</span><span class="p">)</span> <span class="p">{</span> <span class="k">return</span> <span class="n">self</span><span class="p">.</span><span class="n">As</span><span class="o">&lt;</span><span class="n">ir</span><span class="o">::</span><span class="n">IntImm</span><span class="o">&gt;</span><span class="p">()</span><span class="o">-&gt;</span><span class="n">value</span><span class="p">;</span> <span class="p">})</span>
      <span class="p">.</span><span class="n">def</span><span class="p">(</span><span class="s">&quot;float&quot;</span><span class="p">,</span> <span class="p">[](</span><span class="n">ir</span><span class="o">::</span><span class="n">Expr</span> <span class="o">&amp;</span><span class="n">self</span><span class="p">)</span> <span class="p">{</span> <span class="k">return</span> <span class="n">self</span><span class="p">.</span><span class="n">As</span><span class="o">&lt;</span><span class="n">ir</span><span class="o">::</span><span class="n">FloatImm</span><span class="o">&gt;</span><span class="p">()</span><span class="o">-&gt;</span><span class="n">value</span><span class="p">;</span> <span class="p">})</span>

      <span class="p">.</span><span class="n">def</span><span class="p">(</span><span class="s">&quot;__str__&quot;</span><span class="p">,</span> <span class="p">[](</span><span class="k">const</span> <span class="n">Expr</span> <span class="o">&amp;</span><span class="n">self</span><span class="p">)</span> <span class="p">{</span> <span class="k">return</span> <span class="n">utils</span><span class="o">::</span><span class="n">GetStreamCnt</span><span class="p">(</span><span class="n">self</span><span class="p">);</span> <span class="p">})</span>
      <span class="p">.</span><span class="n">def</span><span class="p">(</span><span class="s">&quot;__repr__&quot;</span><span class="p">,</span> <span class="p">[](</span><span class="k">const</span> <span class="n">Expr</span> <span class="o">&amp;</span><span class="n">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">std</span><span class="o">::</span><span class="n">string</span> <span class="p">{</span>
        <span class="n">std</span><span class="o">::</span><span class="n">string</span> <span class="n">content</span> <span class="o">=</span> <span class="n">self</span><span class="p">.</span><span class="n">get</span><span class="p">()</span> <span class="o">?</span> <span class="n">utils</span><span class="o">::</span><span class="n">GetStreamCnt</span><span class="p">(</span><span class="n">self</span><span class="p">)</span> <span class="o">:</span> <span class="s">&quot;&quot;</span><span class="p">;</span>
        <span class="k">return</span> <span class="n">llvm</span><span class="o">::</span><span class="n">formatv</span><span class="p">(</span><span class="s">&quot;&lt;cinn.ir.Expr {0}&gt;&quot;</span><span class="p">,</span> <span class="n">content</span><span class="p">);</span>
      <span class="p">});</span>

  <span class="n">expr</span><span class="p">.</span><span class="n">def</span><span class="p">(</span><span class="s">&quot;as_var_mutable&quot;</span><span class="p">,</span> <span class="n">py</span><span class="o">::</span><span class="n">overload_cast</span><span class="o">&lt;&gt;</span><span class="p">(</span><span class="o">&amp;</span><span class="n">ir</span><span class="o">::</span><span class="n">Expr</span><span class="o">::</span><span class="n">as_var</span><span class="p">),</span> <span class="n">py</span><span class="o">::</span><span class="n">return_value_policy</span><span class="o">::</span><span class="n">reference</span><span class="p">)</span>
      <span class="p">.</span><span class="n">def</span><span class="p">(</span><span class="s">&quot;as_var_const&quot;</span><span class="p">,</span> <span class="n">py</span><span class="o">::</span><span class="n">overload_cast</span><span class="o">&lt;&gt;</span><span class="p">(</span><span class="o">&amp;</span><span class="n">ir</span><span class="o">::</span><span class="n">Expr</span><span class="o">::</span><span class="n">as_var</span><span class="p">,</span> <span class="n">py</span><span class="o">::</span><span class="n">const_</span><span class="p">),</span> <span class="n">py</span><span class="o">::</span><span class="n">return_value_policy</span><span class="o">::</span><span class="n">reference</span><span class="p">)</span>
      <span class="p">.</span><span class="n">def</span><span class="p">(</span><span class="s">&quot;as_var_ref&quot;</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">ir</span><span class="o">::</span><span class="n">Expr</span><span class="o">::</span><span class="n">as_var_ref</span><span class="p">);</span>

  <span class="n">expr</span><span class="p">.</span><span class="n">def</span><span class="p">(</span><span class="s">&quot;as_buffer_mutable&quot;</span><span class="p">,</span> <span class="n">py</span><span class="o">::</span><span class="n">overload_cast</span><span class="o">&lt;&gt;</span><span class="p">(</span><span class="o">&amp;</span><span class="n">ir</span><span class="o">::</span><span class="n">Expr</span><span class="o">::</span><span class="n">as_buffer</span><span class="p">),</span> <span class="n">py</span><span class="o">::</span><span class="n">return_value_policy</span><span class="o">::</span><span class="n">reference</span><span class="p">)</span>
      <span class="p">.</span><span class="n">def</span><span class="p">(</span><span class="s">&quot;as_buffer_const&quot;</span><span class="p">,</span> <span class="n">py</span><span class="o">::</span><span class="n">overload_cast</span><span class="o">&lt;&gt;</span><span class="p">(</span><span class="o">&amp;</span><span class="n">ir</span><span class="o">::</span><span class="n">Expr</span><span class="o">::</span><span class="n">as_buffer</span><span class="p">,</span> <span class="n">py</span><span class="o">::</span><span class="n">const_</span><span class="p">),</span> <span class="n">py</span><span class="o">::</span><span class="n">return_value_policy</span><span class="o">::</span><span class="n">reference</span><span class="p">)</span>
      <span class="p">.</span><span class="n">def</span><span class="p">(</span><span class="s">&quot;as_buffer_ref&quot;</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">ir</span><span class="o">::</span><span class="n">Expr</span><span class="o">::</span><span class="n">as_buffer_ref</span><span class="p">);</span>

  <span class="n">expr</span><span class="p">.</span><span class="n">def</span><span class="p">(</span><span class="s">&quot;is_constant&quot;</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">ir</span><span class="o">::</span><span class="n">Expr</span><span class="o">::</span><span class="n">is_constant</span><span class="p">)</span>
      <span class="p">.</span><span class="n">def</span><span class="p">(</span><span class="s">&quot;get_constant&quot;</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">ir</span><span class="o">::</span><span class="n">Expr</span><span class="o">::</span><span class="n">get_constant</span><span class="p">)</span>
      <span class="p">.</span><span class="n">def</span><span class="p">(</span><span class="s">&quot;is_var&quot;</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">ir</span><span class="o">::</span><span class="n">Expr</span><span class="o">::</span><span class="n">is_var</span><span class="p">)</span>
      <span class="p">.</span><span class="n">def</span><span class="p">(</span><span class="s">&quot;type&quot;</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">ir</span><span class="o">::</span><span class="n">Expr</span><span class="o">::</span><span class="n">type</span><span class="p">);</span>

  <span class="c1">// operators</span>

<span class="cp">#define BIND_POD_BINARY_OP(otype__) \</span>
<span class="cp">  .def(py::self + otype__)          \</span>
<span class="cp">      .def(py::self - otype__)      \</span>
<span class="cp">      .def(py::self *otype__)       \</span>
<span class="cp">      .def(py::self / otype__)      \</span>
<span class="cp">      .def(py::self % otype__)      \</span>
<span class="cp">      .def(py::self &lt; otype__)      \</span>
<span class="cp">      .def(py::self &lt;= otype__)     \</span>
<span class="cp">      .def(py::self &gt; otype__)      \</span>
<span class="cp">      .def(py::self &gt;= otype__)     \</span>
<span class="cp">      .def(otype__ + py::self)      \</span>
<span class="cp">      .def(otype__ - py::self)      \</span>
<span class="cp">      .def(otype__ *py::self)       \</span>
<span class="cp">      .def(otype__ / py::self)      \</span>
<span class="cp">      .def(otype__ % py::self)      \</span>
<span class="cp">      .def(otype__ &lt; py::self)      \</span>
<span class="cp">      .def(otype__ &lt;= py::self)     \</span>
<span class="cp">      .def(otype__ &gt; py::self)      \</span>
<span class="cp">      .def(otype__ &gt;= py::self)</span>

  <span class="n">expr</span>                              <span class="c1">//</span>
      <span class="n">BIND_POD_BINARY_OP</span><span class="p">(</span><span class="n">py</span><span class="o">::</span><span class="n">self</span><span class="p">)</span>  <span class="c1">//</span>
      <span class="n">BIND_POD_BINARY_OP</span><span class="p">(</span><span class="kt">int</span><span class="p">())</span>     <span class="c1">//</span>
      <span class="n">BIND_POD_BINARY_OP</span><span class="p">(</span><span class="kt">float</span><span class="p">());</span>

  <span class="n">expr</span><span class="p">.</span><span class="n">def</span><span class="p">(</span><span class="s">&quot;__add__&quot;</span><span class="p">,</span> <span class="p">[](</span><span class="k">const</span> <span class="n">Expr</span> <span class="o">&amp;</span><span class="n">self</span><span class="p">,</span> <span class="k">const</span> <span class="n">Var</span> <span class="o">&amp;</span><span class="n">other</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Expr</span> <span class="p">{</span> <span class="k">return</span> <span class="n">self</span> <span class="o">+</span> <span class="n">other</span><span class="p">;</span> <span class="p">})</span>
      <span class="p">.</span><span class="n">def</span><span class="p">(</span><span class="s">&quot;__sub__&quot;</span><span class="p">,</span> <span class="p">[](</span><span class="k">const</span> <span class="n">Expr</span> <span class="o">&amp;</span><span class="n">self</span><span class="p">,</span> <span class="k">const</span> <span class="n">Var</span> <span class="o">&amp;</span><span class="n">other</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Expr</span> <span class="p">{</span> <span class="k">return</span> <span class="n">self</span> <span class="o">-</span> <span class="n">other</span><span class="p">;</span> <span class="p">})</span>
      <span class="p">.</span><span class="n">def</span><span class="p">(</span><span class="s">&quot;__mul__&quot;</span><span class="p">,</span> <span class="p">[](</span><span class="k">const</span> <span class="n">Expr</span> <span class="o">&amp;</span><span class="n">self</span><span class="p">,</span> <span class="k">const</span> <span class="n">Var</span> <span class="o">&amp;</span><span class="n">other</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Expr</span> <span class="p">{</span> <span class="k">return</span> <span class="n">self</span> <span class="o">*</span> <span class="n">other</span><span class="p">;</span> <span class="p">})</span>
      <span class="p">.</span><span class="n">def</span><span class="p">(</span><span class="s">&quot;__div__&quot;</span><span class="p">,</span> <span class="p">[](</span><span class="k">const</span> <span class="n">Expr</span> <span class="o">&amp;</span><span class="n">self</span><span class="p">,</span> <span class="k">const</span> <span class="n">Var</span> <span class="o">&amp;</span><span class="n">other</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Expr</span> <span class="p">{</span> <span class="k">return</span> <span class="n">self</span> <span class="o">/</span> <span class="n">other</span><span class="p">;</span> <span class="p">});</span>
<span class="p">}</span>

<span class="kt">void</span> <span class="nf">BindIrVisitor</span><span class="p">(</span><span class="n">py</span><span class="o">::</span><span class="n">module</span> <span class="o">*</span><span class="n">m</span><span class="p">)</span> <span class="p">{</span>
  <span class="n">py</span><span class="o">::</span><span class="n">class_</span><span class="o">&lt;</span><span class="n">ir</span><span class="o">::</span><span class="n">IRVisitor</span><span class="o">&gt;</span> <span class="n">ir_visitor</span><span class="p">(</span><span class="o">*</span><span class="n">m</span><span class="p">,</span> <span class="s">&quot;IRVisitor&quot;</span><span class="p">);</span>
  <span class="n">ir_visitor</span><span class="p">.</span><span class="n">def</span><span class="p">(</span><span class="n">py</span><span class="o">::</span><span class="n">init</span><span class="o">&lt;&gt;</span><span class="p">()).</span><span class="n">def</span><span class="p">(</span><span class="s">&quot;visit&quot;</span><span class="p">,</span> <span class="n">py</span><span class="o">::</span><span class="n">overload_cast</span><span class="o">&lt;</span><span class="k">const</span> <span class="n">ir</span><span class="o">::</span><span class="n">Expr</span> <span class="o">*&gt;</span><span class="p">(</span><span class="o">&amp;</span><span class="n">ir</span><span class="o">::</span><span class="n">IRVisitor</span><span class="o">::</span><span class="n">Visit</span><span class="p">));</span>
<span class="cp">#define DEFINE_VISIT_FN(__ty) ir_visitor.def(&quot;visit&quot;, py::overload_cast&lt;const ir::__ty *&gt;(&amp;ir::IRVisitor::Visit));</span>
  <span class="n">NODETY_FORALL</span><span class="p">(</span><span class="n">DEFINE_VISIT_FN</span><span class="p">)</span>
<span class="cp">#undef DEFINE_VISIT_FN</span>
<span class="p">}</span>

<span class="kt">void</span> <span class="nf">BindIrIr</span><span class="p">(</span><span class="n">py</span><span class="o">::</span><span class="n">module</span> <span class="o">*</span><span class="n">m</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">using</span> <span class="n">ir</span><span class="o">::</span><span class="n">Expr</span><span class="p">;</span>
  <span class="k">using</span> <span class="n">ir</span><span class="o">::</span><span class="n">IrNode</span><span class="p">;</span>
  <span class="k">using</span> <span class="n">ir</span><span class="o">::</span><span class="n">IrNodeRef</span><span class="p">;</span>
  <span class="k">using</span> <span class="n">ir</span><span class="o">::</span><span class="n">Var</span><span class="p">;</span>
  <span class="k">using</span> <span class="n">py</span><span class="o">::</span><span class="n">arg</span><span class="p">;</span>

  <span class="c1">// struct Cast : ExprNode&lt;Cast&gt;</span>
  <span class="n">DefineExprNode</span><span class="o">&lt;</span><span class="n">ir</span><span class="o">::</span><span class="n">Cast</span><span class="o">&gt;</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="s">&quot;Cast&quot;</span><span class="p">);</span>
  <span class="n">py</span><span class="o">::</span><span class="n">class_</span><span class="o">&lt;</span><span class="n">ir</span><span class="o">::</span><span class="n">Cast</span><span class="p">,</span> <span class="n">ExprNode</span><span class="o">&lt;</span><span class="n">ir</span><span class="o">::</span><span class="n">Cast</span><span class="o">&gt;&gt;</span> <span class="n">cast</span><span class="p">(</span><span class="o">*</span><span class="n">m</span><span class="p">,</span> <span class="s">&quot;Cast&quot;</span><span class="p">);</span>
  <span class="n">cast</span><span class="p">.</span><span class="n">def</span><span class="p">(</span><span class="n">py</span><span class="o">::</span><span class="n">init</span><span class="o">&lt;&gt;</span><span class="p">())</span>
      <span class="p">.</span><span class="n">def</span><span class="p">(</span><span class="s">&quot;v_mutable&quot;</span><span class="p">,</span> <span class="n">py</span><span class="o">::</span><span class="n">overload_cast</span><span class="o">&lt;&gt;</span><span class="p">(</span><span class="o">&amp;</span><span class="n">ir</span><span class="o">::</span><span class="n">Cast</span><span class="o">::</span><span class="n">v</span><span class="p">),</span> <span class="n">py</span><span class="o">::</span><span class="n">return_value_policy</span><span class="o">::</span><span class="n">reference</span><span class="p">)</span>
      <span class="p">.</span><span class="n">def</span><span class="p">(</span><span class="s">&quot;v_const&quot;</span><span class="p">,</span> <span class="n">py</span><span class="o">::</span><span class="n">overload_cast</span><span class="o">&lt;&gt;</span><span class="p">(</span><span class="o">&amp;</span><span class="n">ir</span><span class="o">::</span><span class="n">Cast</span><span class="o">::</span><span class="n">v</span><span class="p">,</span> <span class="n">py</span><span class="o">::</span><span class="n">const_</span><span class="p">),</span> <span class="n">py</span><span class="o">::</span><span class="n">return_value_policy</span><span class="o">::</span><span class="n">reference</span><span class="p">);</span>

  <span class="c1">// struct Let : ExprNode&lt;Let&gt;</span>
  <span class="n">DefineExprNode</span><span class="o">&lt;</span><span class="n">ir</span><span class="o">::</span><span class="n">Let</span><span class="o">&gt;</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="s">&quot;Let&quot;</span><span class="p">);</span>
  <span class="n">py</span><span class="o">::</span><span class="n">class_</span><span class="o">&lt;</span><span class="n">ir</span><span class="o">::</span><span class="n">Let</span><span class="p">,</span> <span class="n">ExprNode</span><span class="o">&lt;</span><span class="n">ir</span><span class="o">::</span><span class="n">Let</span><span class="o">&gt;&gt;</span> <span class="n">let</span><span class="p">(</span><span class="o">*</span><span class="n">m</span><span class="p">,</span> <span class="s">&quot;Let&quot;</span><span class="p">);</span>
  <span class="n">let</span><span class="p">.</span><span class="n">def</span><span class="p">(</span><span class="n">py</span><span class="o">::</span><span class="n">init</span><span class="o">&lt;&gt;</span><span class="p">())</span>
      <span class="p">.</span><span class="n">def_readwrite</span><span class="p">(</span><span class="s">&quot;symbol&quot;</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">ir</span><span class="o">::</span><span class="n">Let</span><span class="o">::</span><span class="n">symbol</span><span class="p">)</span>
      <span class="p">.</span><span class="n">def_readwrite</span><span class="p">(</span><span class="s">&quot;body&quot;</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">ir</span><span class="o">::</span><span class="n">Let</span><span class="o">::</span><span class="n">body</span><span class="p">)</span>
      <span class="p">.</span><span class="n">def_static</span><span class="p">(</span><span class="s">&quot;make&quot;</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">ir</span><span class="o">::</span><span class="n">Let</span><span class="o">::</span><span class="n">Make</span><span class="p">)</span>
      <span class="p">.</span><span class="n">def</span><span class="p">(</span><span class="s">&quot;type&quot;</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">ir</span><span class="o">::</span><span class="n">Let</span><span class="o">::</span><span class="n">type</span><span class="p">)</span>
      <span class="p">.</span><span class="n">def</span><span class="p">(</span><span class="s">&quot;expr_fields_mutable&quot;</span><span class="p">,</span> <span class="n">py</span><span class="o">::</span><span class="n">overload_cast</span><span class="o">&lt;&gt;</span><span class="p">(</span><span class="o">&amp;</span><span class="n">ir</span><span class="o">::</span><span class="n">Let</span><span class="o">::</span><span class="n">expr_fields</span><span class="p">))</span>
      <span class="p">.</span><span class="n">def</span><span class="p">(</span><span class="s">&quot;expr_fields_const&quot;</span><span class="p">,</span> <span class="n">py</span><span class="o">::</span><span class="n">overload_cast</span><span class="o">&lt;&gt;</span><span class="p">(</span><span class="o">&amp;</span><span class="n">ir</span><span class="o">::</span><span class="n">Let</span><span class="o">::</span><span class="n">expr_fields</span><span class="p">,</span> <span class="n">py</span><span class="o">::</span><span class="n">const_</span><span class="p">));</span>

  <span class="c1">// struct Reduce : ExprNode&lt;Reduce&gt;</span>
  <span class="n">DefineExprNode</span><span class="o">&lt;</span><span class="n">ir</span><span class="o">::</span><span class="n">Reduce</span><span class="o">&gt;</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="s">&quot;Reduce&quot;</span><span class="p">);</span>
  <span class="n">py</span><span class="o">::</span><span class="n">class_</span><span class="o">&lt;</span><span class="n">ir</span><span class="o">::</span><span class="n">Reduce</span><span class="p">,</span> <span class="n">ExprNode</span><span class="o">&lt;</span><span class="n">ir</span><span class="o">::</span><span class="n">Reduce</span><span class="o">&gt;&gt;</span> <span class="n">reduce</span><span class="p">(</span><span class="o">*</span><span class="n">m</span><span class="p">,</span> <span class="s">&quot;Reduce&quot;</span><span class="p">);</span>
  <span class="n">py</span><span class="o">::</span><span class="n">enum_</span><span class="o">&lt;</span><span class="n">ir</span><span class="o">::</span><span class="n">Reduce</span><span class="o">::</span><span class="n">ReduceType</span><span class="o">&gt;</span> <span class="n">reduce_type</span><span class="p">(</span><span class="n">reduce</span><span class="p">,</span> <span class="s">&quot;ReduceType&quot;</span><span class="p">);</span>
  <span class="n">reduce_type</span>  <span class="c1">//</span>
      <span class="p">.</span><span class="n">value</span><span class="p">(</span><span class="s">&quot;kSum&quot;</span><span class="p">,</span> <span class="n">ir</span><span class="o">::</span><span class="n">Reduce</span><span class="o">::</span><span class="n">ReduceType</span><span class="o">::</span><span class="n">kSum</span><span class="p">)</span>
      <span class="p">.</span><span class="n">value</span><span class="p">(</span><span class="s">&quot;kSub&quot;</span><span class="p">,</span> <span class="n">ir</span><span class="o">::</span><span class="n">Reduce</span><span class="o">::</span><span class="n">ReduceType</span><span class="o">::</span><span class="n">kSub</span><span class="p">)</span>
      <span class="p">.</span><span class="n">value</span><span class="p">(</span><span class="s">&quot;kMul&quot;</span><span class="p">,</span> <span class="n">ir</span><span class="o">::</span><span class="n">Reduce</span><span class="o">::</span><span class="n">ReduceType</span><span class="o">::</span><span class="n">kMul</span><span class="p">)</span>
      <span class="p">.</span><span class="n">value</span><span class="p">(</span><span class="s">&quot;kDiv&quot;</span><span class="p">,</span> <span class="n">ir</span><span class="o">::</span><span class="n">Reduce</span><span class="o">::</span><span class="n">ReduceType</span><span class="o">::</span><span class="n">kDiv</span><span class="p">)</span>
      <span class="p">.</span><span class="n">value</span><span class="p">(</span><span class="s">&quot;kMax&quot;</span><span class="p">,</span> <span class="n">ir</span><span class="o">::</span><span class="n">Reduce</span><span class="o">::</span><span class="n">ReduceType</span><span class="o">::</span><span class="n">kMax</span><span class="p">)</span>
      <span class="p">.</span><span class="n">value</span><span class="p">(</span><span class="s">&quot;kMin&quot;</span><span class="p">,</span> <span class="n">ir</span><span class="o">::</span><span class="n">Reduce</span><span class="o">::</span><span class="n">ReduceType</span><span class="o">::</span><span class="n">kMin</span><span class="p">);</span>

  <span class="n">reduce</span><span class="p">.</span><span class="n">def_readwrite</span><span class="p">(</span><span class="s">&quot;init&quot;</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">ir</span><span class="o">::</span><span class="n">Reduce</span><span class="o">::</span><span class="n">init</span><span class="p">)</span>
      <span class="p">.</span><span class="n">def_readwrite</span><span class="p">(</span><span class="s">&quot;body&quot;</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">ir</span><span class="o">::</span><span class="n">Reduce</span><span class="o">::</span><span class="n">body</span><span class="p">)</span>
      <span class="p">.</span><span class="n">def_readwrite</span><span class="p">(</span><span class="s">&quot;reduce_type&quot;</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">ir</span><span class="o">::</span><span class="n">Reduce</span><span class="o">::</span><span class="n">reduce_type</span><span class="p">)</span>
      <span class="p">.</span><span class="n">def_static</span><span class="p">(</span><span class="s">&quot;make&quot;</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">ir</span><span class="o">::</span><span class="n">Reduce</span><span class="o">::</span><span class="n">Make</span><span class="p">)</span>
      <span class="p">.</span><span class="n">def</span><span class="p">(</span><span class="s">&quot;type&quot;</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">ir</span><span class="o">::</span><span class="n">Reduce</span><span class="o">::</span><span class="n">type</span><span class="p">)</span>
      <span class="p">.</span><span class="n">def</span><span class="p">(</span><span class="s">&quot;expr_fields_mutable&quot;</span><span class="p">,</span> <span class="n">py</span><span class="o">::</span><span class="n">overload_cast</span><span class="o">&lt;&gt;</span><span class="p">(</span><span class="o">&amp;</span><span class="n">ir</span><span class="o">::</span><span class="n">Reduce</span><span class="o">::</span><span class="n">expr_fields</span><span class="p">))</span>
      <span class="p">.</span><span class="n">def</span><span class="p">(</span><span class="s">&quot;expr_fields_const&quot;</span><span class="p">,</span> <span class="n">py</span><span class="o">::</span><span class="n">overload_cast</span><span class="o">&lt;&gt;</span><span class="p">(</span><span class="o">&amp;</span><span class="n">ir</span><span class="o">::</span><span class="n">Reduce</span><span class="o">::</span><span class="n">expr_fields</span><span class="p">,</span> <span class="n">py</span><span class="o">::</span><span class="n">const_</span><span class="p">));</span>

  <span class="c1">// enum class CallType</span>
  <span class="n">py</span><span class="o">::</span><span class="n">enum_</span><span class="o">&lt;</span><span class="n">ir</span><span class="o">::</span><span class="n">CallType</span><span class="o">&gt;</span> <span class="n">call_type</span><span class="p">(</span><span class="o">*</span><span class="n">m</span><span class="p">,</span> <span class="s">&quot;CallType&quot;</span><span class="p">);</span>
  <span class="n">call_type</span><span class="p">.</span><span class="n">value</span><span class="p">(</span><span class="s">&quot;Extern&quot;</span><span class="p">,</span> <span class="n">ir</span><span class="o">::</span><span class="n">CallType</span><span class="o">::</span><span class="n">Extern</span><span class="p">)</span>
      <span class="p">.</span><span class="n">value</span><span class="p">(</span><span class="s">&quot;CINN&quot;</span><span class="p">,</span> <span class="n">ir</span><span class="o">::</span><span class="n">CallType</span><span class="o">::</span><span class="n">CINN</span><span class="p">)</span>
      <span class="p">.</span><span class="n">value</span><span class="p">(</span><span class="s">&quot;Intrinsic&quot;</span><span class="p">,</span> <span class="n">ir</span><span class="o">::</span><span class="n">CallType</span><span class="o">::</span><span class="n">Intrinsic</span><span class="p">)</span>
      <span class="p">.</span><span class="n">value</span><span class="p">(</span><span class="s">&quot;ISL&quot;</span><span class="p">,</span> <span class="n">ir</span><span class="o">::</span><span class="n">CallType</span><span class="o">::</span><span class="n">ISL</span><span class="p">);</span>

  <span class="c1">// struct Call : ExprNode&lt;Call&gt;</span>
  <span class="n">DefineExprNode</span><span class="o">&lt;</span><span class="n">ir</span><span class="o">::</span><span class="n">Call</span><span class="o">&gt;</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="s">&quot;Call&quot;</span><span class="p">);</span>
  <span class="n">py</span><span class="o">::</span><span class="n">class_</span><span class="o">&lt;</span><span class="n">ir</span><span class="o">::</span><span class="n">Call</span><span class="p">,</span> <span class="n">ExprNode</span><span class="o">&lt;</span><span class="n">ir</span><span class="o">::</span><span class="n">Call</span><span class="o">&gt;&gt;</span> <span class="n">call</span><span class="p">(</span><span class="o">*</span><span class="n">m</span><span class="p">,</span> <span class="s">&quot;Call&quot;</span><span class="p">);</span>
  <span class="n">call</span><span class="p">.</span><span class="n">def</span><span class="p">(</span><span class="n">py</span><span class="o">::</span><span class="n">init</span><span class="o">&lt;</span><span class="n">Type</span><span class="o">&gt;</span><span class="p">())</span>
      <span class="p">.</span><span class="n">def_readwrite</span><span class="p">(</span><span class="s">&quot;name&quot;</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">ir</span><span class="o">::</span><span class="n">Call</span><span class="o">::</span><span class="n">name</span><span class="p">)</span>
      <span class="p">.</span><span class="n">def_readwrite</span><span class="p">(</span><span class="s">&quot;read_args&quot;</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">ir</span><span class="o">::</span><span class="n">Call</span><span class="o">::</span><span class="n">read_args</span><span class="p">)</span>
      <span class="p">.</span><span class="n">def_readwrite</span><span class="p">(</span><span class="s">&quot;write_args&quot;</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">ir</span><span class="o">::</span><span class="n">Call</span><span class="o">::</span><span class="n">write_args</span><span class="p">)</span>
      <span class="p">.</span><span class="n">def_readwrite</span><span class="p">(</span><span class="s">&quot;call_type&quot;</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">ir</span><span class="o">::</span><span class="n">Call</span><span class="o">::</span><span class="n">call_type</span><span class="p">)</span>
      <span class="p">.</span><span class="n">def_readwrite</span><span class="p">(</span><span class="s">&quot;func&quot;</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">ir</span><span class="o">::</span><span class="n">Call</span><span class="o">::</span><span class="n">func</span><span class="p">)</span>
      <span class="p">.</span><span class="n">def_readwrite</span><span class="p">(</span><span class="s">&quot;value_index&quot;</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">ir</span><span class="o">::</span><span class="n">Call</span><span class="o">::</span><span class="n">value_index</span><span class="p">)</span>
      <span class="p">.</span><span class="n">def_static</span><span class="p">(</span><span class="s">&quot;make&quot;</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">ir</span><span class="o">::</span><span class="n">Call</span><span class="o">::</span><span class="n">Make</span><span class="p">)</span>
      <span class="p">.</span><span class="n">def</span><span class="p">(</span><span class="s">&quot;total_args_count&quot;</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">ir</span><span class="o">::</span><span class="n">Call</span><span class="o">::</span><span class="n">total_args_count</span><span class="p">)</span>
      <span class="p">.</span><span class="n">def</span><span class="p">(</span><span class="s">&quot;is_extern_call&quot;</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">ir</span><span class="o">::</span><span class="n">Call</span><span class="o">::</span><span class="n">is_extern_call</span><span class="p">)</span>
      <span class="p">.</span><span class="n">def</span><span class="p">(</span><span class="s">&quot;is_cinn_call&quot;</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">ir</span><span class="o">::</span><span class="n">Call</span><span class="o">::</span><span class="n">is_cinn_call</span><span class="p">)</span>
      <span class="p">.</span><span class="n">def</span><span class="p">(</span><span class="s">&quot;is_intrinsic_call&quot;</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">ir</span><span class="o">::</span><span class="n">Call</span><span class="o">::</span><span class="n">is_intrinsic_call</span><span class="p">)</span>
      <span class="p">.</span><span class="n">def</span><span class="p">(</span><span class="s">&quot;is_isl_call&quot;</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">ir</span><span class="o">::</span><span class="n">Call</span><span class="o">::</span><span class="n">is_isl_call</span><span class="p">)</span>
      <span class="p">.</span><span class="n">def</span><span class="p">(</span><span class="s">&quot;expr_fields_mutable&quot;</span><span class="p">,</span> <span class="n">py</span><span class="o">::</span><span class="n">overload_cast</span><span class="o">&lt;&gt;</span><span class="p">(</span><span class="o">&amp;</span><span class="n">ir</span><span class="o">::</span><span class="n">Call</span><span class="o">::</span><span class="n">expr_fields</span><span class="p">))</span>
      <span class="p">.</span><span class="n">def</span><span class="p">(</span><span class="s">&quot;expr_fields_const&quot;</span><span class="p">,</span> <span class="n">py</span><span class="o">::</span><span class="n">overload_cast</span><span class="o">&lt;&gt;</span><span class="p">(</span><span class="o">&amp;</span><span class="n">ir</span><span class="o">::</span><span class="n">Call</span><span class="o">::</span><span class="n">expr_fields</span><span class="p">,</span> <span class="n">py</span><span class="o">::</span><span class="n">const_</span><span class="p">));</span>

  <span class="c1">// struct _Var_ : ExprNode&lt;_Var_&gt;</span>
  <span class="n">DefineExprNode</span><span class="o">&lt;</span><span class="n">ir</span><span class="o">::</span><span class="n">_Var_</span><span class="o">&gt;</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="s">&quot;_Var_&quot;</span><span class="p">);</span>
  <span class="n">py</span><span class="o">::</span><span class="n">class_</span><span class="o">&lt;</span><span class="n">ir</span><span class="o">::</span><span class="n">_Var_</span><span class="p">,</span> <span class="n">ExprNode</span><span class="o">&lt;</span><span class="n">ir</span><span class="o">::</span><span class="n">_Var_</span><span class="o">&gt;&gt;</span> <span class="n">_var_</span><span class="p">(</span><span class="o">*</span><span class="n">m</span><span class="p">,</span> <span class="s">&quot;_Var_&quot;</span><span class="p">);</span>
  <span class="n">_var_</span><span class="p">.</span><span class="n">def_readwrite</span><span class="p">(</span><span class="s">&quot;name&quot;</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">ir</span><span class="o">::</span><span class="n">_Var_</span><span class="o">::</span><span class="n">name</span><span class="p">)</span>
      <span class="p">.</span><span class="n">def_readwrite</span><span class="p">(</span><span class="s">&quot;is_reduce_axis&quot;</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">ir</span><span class="o">::</span><span class="n">_Var_</span><span class="o">::</span><span class="n">is_reduce_axis</span><span class="p">)</span>
      <span class="p">.</span><span class="n">def_readwrite</span><span class="p">(</span><span class="s">&quot;lower_bound&quot;</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">ir</span><span class="o">::</span><span class="n">_Var_</span><span class="o">::</span><span class="n">lower_bound</span><span class="p">)</span>
      <span class="p">.</span><span class="n">def_readwrite</span><span class="p">(</span><span class="s">&quot;upper_bound&quot;</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">ir</span><span class="o">::</span><span class="n">_Var_</span><span class="o">::</span><span class="n">upper_bound</span><span class="p">)</span>
      <span class="p">.</span><span class="n">def_readwrite</span><span class="p">(</span><span class="s">&quot;tag&quot;</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">ir</span><span class="o">::</span><span class="n">_Var_</span><span class="o">::</span><span class="n">tag</span><span class="p">)</span>
      <span class="p">.</span><span class="n">def</span><span class="p">(</span><span class="n">py</span><span class="o">::</span><span class="n">init</span><span class="o">&lt;&gt;</span><span class="p">())</span>
      <span class="p">.</span><span class="n">def</span><span class="p">(</span><span class="n">py</span><span class="o">::</span><span class="n">init</span><span class="o">&lt;</span><span class="k">const</span> <span class="n">std</span><span class="o">::</span><span class="n">string</span> <span class="o">&amp;</span><span class="p">,</span> <span class="n">Type</span><span class="o">&gt;</span><span class="p">())</span>
      <span class="p">.</span><span class="n">def_static</span><span class="p">(</span><span class="s">&quot;make&quot;</span><span class="p">,</span> <span class="n">py</span><span class="o">::</span><span class="n">overload_cast</span><span class="o">&lt;</span><span class="k">const</span> <span class="n">std</span><span class="o">::</span><span class="n">string</span> <span class="o">&amp;</span><span class="p">,</span> <span class="k">const</span> <span class="n">Type</span> <span class="o">&amp;&gt;</span><span class="p">(</span><span class="o">&amp;</span><span class="n">ir</span><span class="o">::</span><span class="n">_Var_</span><span class="o">::</span><span class="n">Make</span><span class="p">))</span>
      <span class="p">.</span><span class="n">def_static</span><span class="p">(</span><span class="s">&quot;make&quot;</span><span class="p">,</span> <span class="n">py</span><span class="o">::</span><span class="n">overload_cast</span><span class="o">&lt;</span><span class="n">ir</span><span class="o">::</span><span class="n">Expr</span><span class="p">,</span> <span class="n">ir</span><span class="o">::</span><span class="n">Expr</span><span class="p">,</span> <span class="k">const</span> <span class="n">std</span><span class="o">::</span><span class="n">string</span> <span class="o">&amp;&gt;</span><span class="p">(</span><span class="o">&amp;</span><span class="n">ir</span><span class="o">::</span><span class="n">_Var_</span><span class="o">::</span><span class="n">Make</span><span class="p">))</span>
      <span class="p">.</span><span class="n">def</span><span class="p">(</span><span class="s">&quot;copy&quot;</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">ir</span><span class="o">::</span><span class="n">_Var_</span><span class="o">::</span><span class="n">Copy</span><span class="p">);</span>

  <span class="c1">// struct Select</span>
  <span class="n">DefineExprNode</span><span class="o">&lt;</span><span class="n">ir</span><span class="o">::</span><span class="n">Select</span><span class="o">&gt;</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="s">&quot;Select&quot;</span><span class="p">);</span>
  <span class="n">py</span><span class="o">::</span><span class="n">class_</span><span class="o">&lt;</span><span class="n">ir</span><span class="o">::</span><span class="n">Select</span><span class="p">,</span> <span class="n">ExprNode</span><span class="o">&lt;</span><span class="n">ir</span><span class="o">::</span><span class="n">Select</span><span class="o">&gt;&gt;</span> <span class="n">select</span><span class="p">(</span><span class="o">*</span><span class="n">m</span><span class="p">,</span> <span class="s">&quot;Select&quot;</span><span class="p">);</span>
  <span class="n">select</span><span class="p">.</span><span class="n">def_readwrite</span><span class="p">(</span><span class="s">&quot;condition&quot;</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">ir</span><span class="o">::</span><span class="n">Select</span><span class="o">::</span><span class="n">condition</span><span class="p">)</span>
      <span class="p">.</span><span class="n">def_readwrite</span><span class="p">(</span><span class="s">&quot;true_value&quot;</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">ir</span><span class="o">::</span><span class="n">Select</span><span class="o">::</span><span class="n">true_value</span><span class="p">)</span>
      <span class="p">.</span><span class="n">def_readwrite</span><span class="p">(</span><span class="s">&quot;false_value&quot;</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">ir</span><span class="o">::</span><span class="n">Select</span><span class="o">::</span><span class="n">false_value</span><span class="p">)</span>
      <span class="p">.</span><span class="n">def</span><span class="p">(</span><span class="n">py</span><span class="o">::</span><span class="n">init</span><span class="o">&lt;</span><span class="n">ir</span><span class="o">::</span><span class="n">Expr</span><span class="p">,</span> <span class="n">ir</span><span class="o">::</span><span class="n">Expr</span><span class="p">,</span> <span class="n">ir</span><span class="o">::</span><span class="n">Expr</span><span class="o">&gt;</span><span class="p">())</span>
      <span class="p">.</span><span class="n">def_static</span><span class="p">(</span><span class="s">&quot;make&quot;</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">ir</span><span class="o">::</span><span class="n">Select</span><span class="o">::</span><span class="n">Make</span><span class="p">)</span>
      <span class="p">.</span><span class="n">def</span><span class="p">(</span><span class="s">&quot;type&quot;</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">ir</span><span class="o">::</span><span class="n">Select</span><span class="o">::</span><span class="n">type</span><span class="p">)</span>
      <span class="p">.</span><span class="n">def</span><span class="p">(</span><span class="s">&quot;expr_fields_mutable&quot;</span><span class="p">,</span> <span class="n">py</span><span class="o">::</span><span class="n">overload_cast</span><span class="o">&lt;&gt;</span><span class="p">(</span><span class="o">&amp;</span><span class="n">ir</span><span class="o">::</span><span class="n">Select</span><span class="o">::</span><span class="n">expr_fields</span><span class="p">))</span>
      <span class="p">.</span><span class="n">def</span><span class="p">(</span><span class="s">&quot;expr_fields_const&quot;</span><span class="p">,</span> <span class="n">py</span><span class="o">::</span><span class="n">overload_cast</span><span class="o">&lt;&gt;</span><span class="p">(</span><span class="o">&amp;</span><span class="n">ir</span><span class="o">::</span><span class="n">Select</span><span class="o">::</span><span class="n">expr_fields</span><span class="p">,</span> <span class="n">py</span><span class="o">::</span><span class="n">const_</span><span class="p">));</span>

  <span class="c1">// struct LoadStoreAddrMnger</span>
  <span class="n">py</span><span class="o">::</span><span class="n">class_</span><span class="o">&lt;</span><span class="n">ir</span><span class="o">::</span><span class="n">LoadStoreAddrMnger</span><span class="o">&gt;</span> <span class="n">load_store_addr_manager</span><span class="p">(</span><span class="o">*</span><span class="n">m</span><span class="p">,</span> <span class="s">&quot;LoadStoreAddrMnger&quot;</span><span class="p">);</span>
  <span class="n">load_store_addr_manager</span><span class="p">.</span><span class="n">def_readwrite</span><span class="p">(</span><span class="s">&quot;tensor&quot;</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">ir</span><span class="o">::</span><span class="n">LoadStoreAddrMnger</span><span class="o">::</span><span class="n">tensor</span><span class="p">)</span>
      <span class="p">.</span><span class="n">def</span><span class="p">(</span><span class="s">&quot;is_addr_tensor&quot;</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">ir</span><span class="o">::</span><span class="n">LoadStoreAddrMnger</span><span class="o">::</span><span class="n">is_addr_tensor</span><span class="p">)</span>
      <span class="p">.</span><span class="n">def</span><span class="p">(</span><span class="s">&quot;is_addr_scalar&quot;</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">ir</span><span class="o">::</span><span class="n">LoadStoreAddrMnger</span><span class="o">::</span><span class="n">is_addr_scalar</span><span class="p">);</span>

  <span class="c1">// struct Load : ExprNode&lt;Load&gt;, LoadStoreAddrMnger</span>
  <span class="n">DefineExprNode</span><span class="o">&lt;</span><span class="n">ir</span><span class="o">::</span><span class="n">Load</span><span class="o">&gt;</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="s">&quot;Load&quot;</span><span class="p">);</span>
  <span class="n">py</span><span class="o">::</span><span class="n">class_</span><span class="o">&lt;</span><span class="n">ir</span><span class="o">::</span><span class="n">Load</span><span class="p">,</span> <span class="n">ExprNode</span><span class="o">&lt;</span><span class="n">ir</span><span class="o">::</span><span class="n">Load</span><span class="o">&gt;</span><span class="p">,</span> <span class="n">ir</span><span class="o">::</span><span class="n">LoadStoreAddrMnger</span><span class="o">&gt;</span> <span class="n">load</span><span class="p">(</span><span class="o">*</span><span class="n">m</span><span class="p">,</span> <span class="s">&quot;Load&quot;</span><span class="p">);</span>
  <span class="n">load</span><span class="p">.</span><span class="n">def_readwrite</span><span class="p">(</span><span class="s">&quot;indices&quot;</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">ir</span><span class="o">::</span><span class="n">Load</span><span class="o">::</span><span class="n">indices</span><span class="p">)</span>
      <span class="p">.</span><span class="n">def</span><span class="p">(</span><span class="s">&quot;index&quot;</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">ir</span><span class="o">::</span><span class="n">Load</span><span class="o">::</span><span class="n">index</span><span class="p">)</span>
      <span class="p">.</span><span class="n">def_static</span><span class="p">(</span><span class="s">&quot;make&quot;</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">ir</span><span class="o">::</span><span class="n">Load</span><span class="o">::</span><span class="n">Make</span><span class="p">)</span>
      <span class="p">.</span><span class="n">def</span><span class="p">(</span><span class="s">&quot;expr_fields_mutable&quot;</span><span class="p">,</span> <span class="n">py</span><span class="o">::</span><span class="n">overload_cast</span><span class="o">&lt;&gt;</span><span class="p">(</span><span class="o">&amp;</span><span class="n">ir</span><span class="o">::</span><span class="n">Load</span><span class="o">::</span><span class="n">expr_fields</span><span class="p">))</span>
      <span class="p">.</span><span class="n">def</span><span class="p">(</span><span class="s">&quot;expr_fields_const&quot;</span><span class="p">,</span> <span class="n">py</span><span class="o">::</span><span class="n">overload_cast</span><span class="o">&lt;&gt;</span><span class="p">(</span><span class="o">&amp;</span><span class="n">ir</span><span class="o">::</span><span class="n">Load</span><span class="o">::</span><span class="n">expr_fields</span><span class="p">,</span> <span class="n">py</span><span class="o">::</span><span class="n">const_</span><span class="p">))</span>
      <span class="p">.</span><span class="n">def</span><span class="p">(</span><span class="s">&quot;name&quot;</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">ir</span><span class="o">::</span><span class="n">Load</span><span class="o">::</span><span class="n">name</span><span class="p">)</span>
      <span class="p">.</span><span class="n">def</span><span class="p">(</span><span class="s">&quot;type&quot;</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">ir</span><span class="o">::</span><span class="n">Load</span><span class="o">::</span><span class="n">type</span><span class="p">);</span>

  <span class="c1">// struct Store : ExprNode&lt;Store&gt;, LoadStoreAddrMnger</span>
  <span class="n">DefineExprNode</span><span class="o">&lt;</span><span class="n">ir</span><span class="o">::</span><span class="n">Store</span><span class="o">&gt;</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="s">&quot;Store&quot;</span><span class="p">);</span>
  <span class="n">py</span><span class="o">::</span><span class="n">class_</span><span class="o">&lt;</span><span class="n">ir</span><span class="o">::</span><span class="n">Store</span><span class="p">,</span> <span class="n">ExprNode</span><span class="o">&lt;</span><span class="n">ir</span><span class="o">::</span><span class="n">Store</span><span class="o">&gt;</span><span class="p">,</span> <span class="n">ir</span><span class="o">::</span><span class="n">LoadStoreAddrMnger</span><span class="o">&gt;</span> <span class="n">store</span><span class="p">(</span><span class="o">*</span><span class="n">m</span><span class="p">,</span> <span class="s">&quot;Store&quot;</span><span class="p">);</span>
  <span class="n">store</span><span class="p">.</span><span class="n">def_readwrite</span><span class="p">(</span><span class="s">&quot;value&quot;</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">ir</span><span class="o">::</span><span class="n">Store</span><span class="o">::</span><span class="n">value</span><span class="p">)</span>
      <span class="p">.</span><span class="n">def_readwrite</span><span class="p">(</span><span class="s">&quot;indices&quot;</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">ir</span><span class="o">::</span><span class="n">Store</span><span class="o">::</span><span class="n">indices</span><span class="p">)</span>
      <span class="p">.</span><span class="n">def_static</span><span class="p">(</span><span class="s">&quot;make&quot;</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">ir</span><span class="o">::</span><span class="n">Store</span><span class="o">::</span><span class="n">Make</span><span class="p">)</span>
      <span class="p">.</span><span class="n">def</span><span class="p">(</span><span class="s">&quot;expr_fields_mutable&quot;</span><span class="p">,</span> <span class="n">py</span><span class="o">::</span><span class="n">overload_cast</span><span class="o">&lt;&gt;</span><span class="p">(</span><span class="o">&amp;</span><span class="n">ir</span><span class="o">::</span><span class="n">Store</span><span class="o">::</span><span class="n">expr_fields</span><span class="p">))</span>
      <span class="p">.</span><span class="n">def</span><span class="p">(</span><span class="s">&quot;expr_fields_const&quot;</span><span class="p">,</span> <span class="n">py</span><span class="o">::</span><span class="n">overload_cast</span><span class="o">&lt;&gt;</span><span class="p">(</span><span class="o">&amp;</span><span class="n">ir</span><span class="o">::</span><span class="n">Store</span><span class="o">::</span><span class="n">expr_fields</span><span class="p">,</span> <span class="n">py</span><span class="o">::</span><span class="n">const_</span><span class="p">))</span>
      <span class="p">.</span><span class="n">def</span><span class="p">(</span><span class="s">&quot;type&quot;</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">ir</span><span class="o">::</span><span class="n">Store</span><span class="o">::</span><span class="n">type</span><span class="p">)</span>
      <span class="p">.</span><span class="n">def</span><span class="p">(</span><span class="s">&quot;index&quot;</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">ir</span><span class="o">::</span><span class="n">Store</span><span class="o">::</span><span class="n">index</span><span class="p">);</span>

<span class="cp">#define DEFINE_BINARY_NODE(__node)                                               \</span>
<span class="cp">  DefineBinaryOpNode&lt;ir::__node&gt;(m, #__node);                                    \</span>
<span class="cp">  py::class_&lt;ir::__node, ir::BinaryOpNode&lt;ir::__node&gt;&gt; py_##__node(*m, #__node); \</span>
<span class="cp">  py_##__node.def(py::init&lt;ir::Expr, ir::Expr&gt;()).def_static(&quot;make&quot;, &amp;ir::__node::Make).def(&quot;type&quot;, &amp;ir::__node::type)</span>

  <span class="n">DEFINE_BINARY_NODE</span><span class="p">(</span><span class="n">Add</span><span class="p">);</span>
  <span class="n">DEFINE_BINARY_NODE</span><span class="p">(</span><span class="n">Sub</span><span class="p">);</span>
  <span class="n">DEFINE_BINARY_NODE</span><span class="p">(</span><span class="n">Mul</span><span class="p">);</span>
  <span class="n">DEFINE_BINARY_NODE</span><span class="p">(</span><span class="n">Div</span><span class="p">);</span>
  <span class="n">DEFINE_BINARY_NODE</span><span class="p">(</span><span class="n">Mod</span><span class="p">);</span>
  <span class="n">DEFINE_BINARY_NODE</span><span class="p">(</span><span class="n">Min</span><span class="p">);</span>
  <span class="n">DEFINE_BINARY_NODE</span><span class="p">(</span><span class="n">Max</span><span class="p">);</span>
  <span class="n">DEFINE_BINARY_NODE</span><span class="p">(</span><span class="n">EQ</span><span class="p">);</span>
  <span class="n">DEFINE_BINARY_NODE</span><span class="p">(</span><span class="n">NE</span><span class="p">);</span>
  <span class="n">DEFINE_BINARY_NODE</span><span class="p">(</span><span class="n">LT</span><span class="p">);</span>
  <span class="n">DEFINE_BINARY_NODE</span><span class="p">(</span><span class="n">LE</span><span class="p">);</span>
  <span class="n">DEFINE_BINARY_NODE</span><span class="p">(</span><span class="n">GT</span><span class="p">);</span>
  <span class="n">DEFINE_BINARY_NODE</span><span class="p">(</span><span class="n">GE</span><span class="p">);</span>
  <span class="n">DEFINE_BINARY_NODE</span><span class="p">(</span><span class="n">And</span><span class="p">);</span>
  <span class="n">DEFINE_BINARY_NODE</span><span class="p">(</span><span class="n">Or</span><span class="p">);</span>

<span class="cp">#undef DEFINE_BINARY_NODE</span>

  <span class="c1">// FracOp</span>
  <span class="n">DefineBinaryOpNode</span><span class="o">&lt;</span><span class="n">ir</span><span class="o">::</span><span class="n">FracOp</span><span class="o">&gt;</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="s">&quot;FracOp&quot;</span><span class="p">);</span>
  <span class="n">py</span><span class="o">::</span><span class="n">class_</span><span class="o">&lt;</span><span class="n">ir</span><span class="o">::</span><span class="n">FracOp</span><span class="p">,</span> <span class="n">ir</span><span class="o">::</span><span class="n">BinaryOpNode</span><span class="o">&lt;</span><span class="n">ir</span><span class="o">::</span><span class="n">FracOp</span><span class="o">&gt;&gt;</span> <span class="n">frac_op</span><span class="p">(</span><span class="o">*</span><span class="n">m</span><span class="p">,</span> <span class="s">&quot;FracOp&quot;</span><span class="p">);</span>
  <span class="n">frac_op</span><span class="p">.</span><span class="n">def</span><span class="p">(</span><span class="n">py</span><span class="o">::</span><span class="n">init</span><span class="o">&lt;&gt;</span><span class="p">()).</span><span class="n">def_static</span><span class="p">(</span><span class="s">&quot;make&quot;</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">ir</span><span class="o">::</span><span class="n">FracOp</span><span class="o">::</span><span class="n">Make</span><span class="p">).</span><span class="n">def</span><span class="p">(</span><span class="s">&quot;type&quot;</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">ir</span><span class="o">::</span><span class="n">FracOp</span><span class="o">::</span><span class="n">type</span><span class="p">);</span>

<span class="cp">#define DEFINE_UNARY_NODE(__node)                                               \</span>
<span class="cp">  DefineUnaryOpNode&lt;ir::__node&gt;(m, #__node);                                    \</span>
<span class="cp">  py::class_&lt;ir::__node, ir::UnaryOpNode&lt;ir::__node&gt;&gt; py_##__node(*m, #__node); \</span>
<span class="cp">  py_##__node.def(py::init&lt;ir::Expr&gt;()).def_static(&quot;make&quot;, &amp;ir::__node::Make)</span>

  <span class="n">DEFINE_UNARY_NODE</span><span class="p">(</span><span class="n">Minus</span><span class="p">);</span>
  <span class="n">DEFINE_UNARY_NODE</span><span class="p">(</span><span class="n">Not</span><span class="p">);</span>
<span class="cp">#undef DEFINE_UNARY_NODE</span>

  <span class="n">py</span><span class="o">::</span><span class="n">class_</span><span class="o">&lt;</span><span class="n">Var</span><span class="p">,</span> <span class="n">IrNodeRef</span><span class="o">&gt;</span> <span class="n">var</span><span class="p">(</span><span class="o">*</span><span class="n">m</span><span class="p">,</span> <span class="s">&quot;Var&quot;</span><span class="p">);</span>
  <span class="n">var</span><span class="p">.</span><span class="n">def</span><span class="p">(</span><span class="n">py</span><span class="o">::</span><span class="n">init</span><span class="o">&lt;&gt;</span><span class="p">())</span>
      <span class="p">.</span><span class="n">def</span><span class="p">(</span><span class="n">py</span><span class="o">::</span><span class="n">init</span><span class="o">&lt;</span><span class="n">IrNode</span> <span class="o">*&gt;</span><span class="p">())</span>
      <span class="p">.</span><span class="n">def</span><span class="p">(</span><span class="n">py</span><span class="o">::</span><span class="n">init</span><span class="o">&lt;</span><span class="k">const</span> <span class="n">std</span><span class="o">::</span><span class="n">string</span> <span class="o">&amp;</span><span class="p">,</span> <span class="n">common</span><span class="o">::</span><span class="n">Type</span><span class="o">&gt;</span><span class="p">(),</span> <span class="n">arg</span><span class="p">(</span><span class="s">&quot;name_hint&quot;</span><span class="p">),</span> <span class="n">arg</span><span class="p">(</span><span class="s">&quot;t&quot;</span><span class="p">)</span> <span class="o">=</span> <span class="n">common</span><span class="o">::</span><span class="n">type_of</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span><span class="p">())</span>
      <span class="p">.</span><span class="n">def</span><span class="p">(</span><span class="n">py</span><span class="o">::</span><span class="n">init</span><span class="o">&lt;</span><span class="n">Expr</span><span class="p">,</span> <span class="n">Expr</span><span class="p">,</span> <span class="k">const</span> <span class="n">std</span><span class="o">::</span><span class="n">string</span> <span class="o">&amp;&gt;</span><span class="p">())</span>
      <span class="p">.</span><span class="n">def</span><span class="p">(</span><span class="n">py</span><span class="o">::</span><span class="n">init</span><span class="o">&lt;</span><span class="kt">int</span><span class="p">,</span> <span class="k">const</span> <span class="n">std</span><span class="o">::</span><span class="n">string</span> <span class="o">&amp;&gt;</span><span class="p">())</span>
      <span class="p">.</span><span class="n">def</span><span class="p">(</span><span class="n">py</span><span class="o">::</span><span class="n">init</span><span class="o">&lt;</span><span class="n">Expr</span><span class="p">,</span> <span class="k">const</span> <span class="n">std</span><span class="o">::</span><span class="n">string</span> <span class="o">&amp;&gt;</span><span class="p">())</span>
      <span class="p">.</span><span class="n">def</span><span class="p">(</span><span class="s">&quot;get_mutable&quot;</span><span class="p">,</span> <span class="n">py</span><span class="o">::</span><span class="n">overload_cast</span><span class="o">&lt;&gt;</span><span class="p">(</span><span class="o">&amp;</span><span class="n">Var</span><span class="o">::</span><span class="n">get</span><span class="p">),</span> <span class="n">py</span><span class="o">::</span><span class="n">return_value_policy</span><span class="o">::</span><span class="n">reference</span><span class="p">)</span>
      <span class="p">.</span><span class="n">def</span><span class="p">(</span><span class="s">&quot;get_const&quot;</span><span class="p">,</span> <span class="n">py</span><span class="o">::</span><span class="n">overload_cast</span><span class="o">&lt;&gt;</span><span class="p">(</span><span class="o">&amp;</span><span class="n">Var</span><span class="o">::</span><span class="n">get</span><span class="p">,</span> <span class="n">py</span><span class="o">::</span><span class="n">const_</span><span class="p">),</span> <span class="n">py</span><span class="o">::</span><span class="n">return_value_policy</span><span class="o">::</span><span class="n">reference</span><span class="p">)</span>
      <span class="p">.</span><span class="n">def</span><span class="p">(</span><span class="s">&quot;to_expr_mutable&quot;</span><span class="p">,</span> <span class="n">py</span><span class="o">::</span><span class="n">overload_cast</span><span class="o">&lt;&gt;</span><span class="p">(</span><span class="o">&amp;</span><span class="n">Var</span><span class="o">::</span><span class="k">operator</span> <span class="n">ir</span><span class="o">::</span><span class="n">Expr</span><span class="p">))</span>
      <span class="p">.</span><span class="n">def</span><span class="p">(</span><span class="s">&quot;to_expr_const&quot;</span><span class="p">,</span> <span class="n">py</span><span class="o">::</span><span class="n">overload_cast</span><span class="o">&lt;&gt;</span><span class="p">(</span><span class="o">&amp;</span><span class="n">Var</span><span class="o">::</span><span class="k">operator</span> <span class="n">ir</span><span class="o">::</span><span class="n">Expr</span><span class="p">,</span> <span class="n">py</span><span class="o">::</span><span class="n">const_</span><span class="p">))</span>
      <span class="p">.</span><span class="n">def</span><span class="p">(</span><span class="s">&quot;__repr__&quot;</span><span class="p">,</span> <span class="p">[](</span><span class="n">Var</span> <span class="o">&amp;</span><span class="n">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">std</span><span class="o">::</span><span class="n">string</span> <span class="p">{</span> <span class="k">return</span> <span class="n">llvm</span><span class="o">::</span><span class="n">formatv</span><span class="p">(</span><span class="s">&quot;&lt;cinn.ir.Var {0}&gt;&quot;</span><span class="p">,</span> <span class="n">self</span><span class="o">-&gt;</span><span class="n">name</span><span class="p">);</span> <span class="p">})</span>
      <span class="p">.</span><span class="n">def</span><span class="p">(</span><span class="s">&quot;expr&quot;</span><span class="p">,</span> <span class="p">[](</span><span class="n">Var</span> <span class="o">&amp;</span><span class="n">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Expr</span> <span class="p">{</span> <span class="k">return</span> <span class="n">Expr</span><span class="p">(</span><span class="n">self</span><span class="o">-&gt;</span><span class="n">self</span><span class="p">());</span> <span class="p">})</span>

          <span class="n">BIND_POD_BINARY_OP</span><span class="p">(</span><span class="kt">int</span><span class="p">())</span>  <span class="c1">//</span>
      <span class="n">BIND_POD_BINARY_OP</span><span class="p">(</span><span class="kt">int32_t</span><span class="p">())</span>  <span class="c1">//</span>
      <span class="n">BIND_POD_BINARY_OP</span><span class="p">(</span><span class="kt">float</span><span class="p">())</span>

<span class="cp">#define BINARY_OP(type__)                                                       \</span>
<span class="cp">  .def(&quot;__add__&quot;, [](Var &amp;self, type__ v) -&gt; Expr { return self + v; })         \</span>
<span class="cp">      .def(&quot;__sub__&quot;, [](Var &amp;self, type__ v) -&gt; Expr { return self - v; })     \</span>
<span class="cp">      .def(&quot;__truediv__&quot;, [](Var &amp;self, type__ v) -&gt; Expr { return self / v; }) \</span>
<span class="cp">      .def(&quot;__mul__&quot;, [](Var &amp;self, type__ v) -&gt; Expr { return self * v; })     \</span>
<span class="cp">      .def(&quot;__mod__&quot;, [](Var &amp;self, type__ v) -&gt; Expr { return self % v; })</span>

          <span class="n">BINARY_OP</span><span class="p">(</span><span class="kt">int32_t</span><span class="p">)</span>  <span class="c1">//</span>
      <span class="n">BINARY_OP</span><span class="p">(</span><span class="kt">int64_t</span><span class="p">)</span>      <span class="c1">//</span>
      <span class="n">BINARY_OP</span><span class="p">(</span><span class="kt">float</span><span class="p">)</span>        <span class="c1">//</span>
      <span class="n">BINARY_OP</span><span class="p">(</span><span class="kt">double</span><span class="p">);</span>
<span class="cp">#undef BINARY_OP</span>

  <span class="n">DefineExprNode</span><span class="o">&lt;</span><span class="n">ir</span><span class="o">::</span><span class="n">Power</span><span class="o">&gt;</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="s">&quot;Power&quot;</span><span class="p">);</span>
  <span class="n">py</span><span class="o">::</span><span class="n">class_</span><span class="o">&lt;</span><span class="n">ir</span><span class="o">::</span><span class="n">Power</span><span class="p">,</span> <span class="n">ir</span><span class="o">::</span><span class="n">ExprNode</span><span class="o">&lt;</span><span class="n">ir</span><span class="o">::</span><span class="n">Power</span><span class="o">&gt;&gt;</span> <span class="n">power</span><span class="p">(</span><span class="o">*</span><span class="n">m</span><span class="p">,</span> <span class="s">&quot;Power&quot;</span><span class="p">);</span>
  <span class="n">power</span><span class="p">.</span><span class="n">def</span><span class="p">(</span><span class="n">py</span><span class="o">::</span><span class="n">init</span><span class="o">&lt;&gt;</span><span class="p">())</span>
      <span class="p">.</span><span class="n">def_static</span><span class="p">(</span><span class="s">&quot;make&quot;</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">ir</span><span class="o">::</span><span class="n">Power</span><span class="o">::</span><span class="n">Make</span><span class="p">)</span>
      <span class="p">.</span><span class="n">def</span><span class="p">(</span><span class="s">&quot;type&quot;</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">ir</span><span class="o">::</span><span class="n">Power</span><span class="o">::</span><span class="n">type</span><span class="p">)</span>
      <span class="p">.</span><span class="n">def</span><span class="p">(</span><span class="s">&quot;a_const&quot;</span><span class="p">,</span> <span class="n">py</span><span class="o">::</span><span class="n">overload_cast</span><span class="o">&lt;&gt;</span><span class="p">(</span><span class="o">&amp;</span><span class="n">ir</span><span class="o">::</span><span class="n">Power</span><span class="o">::</span><span class="n">a</span><span class="p">,</span> <span class="n">py</span><span class="o">::</span><span class="n">const_</span><span class="p">),</span> <span class="n">py</span><span class="o">::</span><span class="n">return_value_policy</span><span class="o">::</span><span class="n">reference</span><span class="p">)</span>
      <span class="p">.</span><span class="n">def</span><span class="p">(</span><span class="s">&quot;a_mutable&quot;</span><span class="p">,</span> <span class="n">py</span><span class="o">::</span><span class="n">overload_cast</span><span class="o">&lt;&gt;</span><span class="p">(</span><span class="o">&amp;</span><span class="n">ir</span><span class="o">::</span><span class="n">Power</span><span class="o">::</span><span class="n">a</span><span class="p">),</span> <span class="n">py</span><span class="o">::</span><span class="n">return_value_policy</span><span class="o">::</span><span class="n">reference</span><span class="p">)</span>
      <span class="p">.</span><span class="n">def</span><span class="p">(</span><span class="s">&quot;b_const&quot;</span><span class="p">,</span> <span class="n">py</span><span class="o">::</span><span class="n">overload_cast</span><span class="o">&lt;&gt;</span><span class="p">(</span><span class="o">&amp;</span><span class="n">ir</span><span class="o">::</span><span class="n">Power</span><span class="o">::</span><span class="n">b</span><span class="p">,</span> <span class="n">py</span><span class="o">::</span><span class="n">const_</span><span class="p">),</span> <span class="n">py</span><span class="o">::</span><span class="n">return_value_policy</span><span class="o">::</span><span class="n">reference</span><span class="p">)</span>
      <span class="p">.</span><span class="n">def</span><span class="p">(</span><span class="s">&quot;b_mutable&quot;</span><span class="p">,</span> <span class="n">py</span><span class="o">::</span><span class="n">overload_cast</span><span class="o">&lt;&gt;</span><span class="p">(</span><span class="o">&amp;</span><span class="n">ir</span><span class="o">::</span><span class="n">Power</span><span class="o">::</span><span class="n">b</span><span class="p">),</span> <span class="n">py</span><span class="o">::</span><span class="n">return_value_policy</span><span class="o">::</span><span class="n">reference</span><span class="p">)</span>
      <span class="p">.</span><span class="n">def</span><span class="p">(</span><span class="s">&quot;is_constant&quot;</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">ir</span><span class="o">::</span><span class="n">Power</span><span class="o">::</span><span class="n">is_constant</span><span class="p">)</span>
      <span class="p">.</span><span class="n">def</span><span class="p">(</span><span class="s">&quot;operands_mutable&quot;</span><span class="p">,</span> <span class="n">py</span><span class="o">::</span><span class="n">overload_cast</span><span class="o">&lt;&gt;</span><span class="p">(</span><span class="o">&amp;</span><span class="n">ir</span><span class="o">::</span><span class="n">Power</span><span class="o">::</span><span class="n">operands</span><span class="p">))</span>
      <span class="p">.</span><span class="n">def</span><span class="p">(</span><span class="s">&quot;operands_const&quot;</span><span class="p">,</span> <span class="n">py</span><span class="o">::</span><span class="n">overload_cast</span><span class="o">&lt;&gt;</span><span class="p">(</span><span class="o">&amp;</span><span class="n">ir</span><span class="o">::</span><span class="n">Power</span><span class="o">::</span><span class="n">operands</span><span class="p">,</span> <span class="n">py</span><span class="o">::</span><span class="n">const_</span><span class="p">));</span>

  <span class="n">DefineExprNode</span><span class="o">&lt;</span><span class="n">ir</span><span class="o">::</span><span class="n">Product</span><span class="o">&gt;</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="s">&quot;Product&quot;</span><span class="p">);</span>
  <span class="n">py</span><span class="o">::</span><span class="n">class_</span><span class="o">&lt;</span><span class="n">ir</span><span class="o">::</span><span class="n">Product</span><span class="p">,</span> <span class="n">ir</span><span class="o">::</span><span class="n">ExprNode</span><span class="o">&lt;</span><span class="n">ir</span><span class="o">::</span><span class="n">Product</span><span class="o">&gt;&gt;</span> <span class="n">product</span><span class="p">(</span><span class="o">*</span><span class="n">m</span><span class="p">,</span> <span class="s">&quot;Product&quot;</span><span class="p">);</span>
  <span class="n">product</span><span class="p">.</span><span class="n">def_static</span><span class="p">(</span><span class="s">&quot;make&quot;</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">ir</span><span class="o">::</span><span class="n">Product</span><span class="o">::</span><span class="n">Make</span><span class="p">)</span>
      <span class="p">.</span><span class="n">def</span><span class="p">(</span><span class="s">&quot;type&quot;</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">ir</span><span class="o">::</span><span class="n">Product</span><span class="o">::</span><span class="n">type</span><span class="p">)</span>
      <span class="p">.</span><span class="n">def</span><span class="p">(</span><span class="s">&quot;operand_mutable&quot;</span><span class="p">,</span> <span class="n">py</span><span class="o">::</span><span class="n">overload_cast</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span><span class="p">(</span><span class="o">&amp;</span><span class="n">ir</span><span class="o">::</span><span class="n">Product</span><span class="o">::</span><span class="n">operand</span><span class="p">),</span> <span class="n">py</span><span class="o">::</span><span class="n">return_value_policy</span><span class="o">::</span><span class="n">reference</span><span class="p">)</span>
      <span class="p">.</span><span class="n">def</span><span class="p">(</span><span class="s">&quot;operand_const&quot;</span><span class="p">,</span>
           <span class="n">py</span><span class="o">::</span><span class="n">overload_cast</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span><span class="p">(</span><span class="o">&amp;</span><span class="n">ir</span><span class="o">::</span><span class="n">Product</span><span class="o">::</span><span class="n">operand</span><span class="p">,</span> <span class="n">py</span><span class="o">::</span><span class="n">const_</span><span class="p">),</span>
           <span class="n">py</span><span class="o">::</span><span class="n">return_value_policy</span><span class="o">::</span><span class="n">reference</span><span class="p">);</span>

  <span class="n">DefineExprNode</span><span class="o">&lt;</span><span class="n">ir</span><span class="o">::</span><span class="n">Sum</span><span class="o">&gt;</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="s">&quot;Sum&quot;</span><span class="p">);</span>
  <span class="n">py</span><span class="o">::</span><span class="n">class_</span><span class="o">&lt;</span><span class="n">ir</span><span class="o">::</span><span class="n">Sum</span><span class="p">,</span> <span class="n">ir</span><span class="o">::</span><span class="n">ExprNode</span><span class="o">&lt;</span><span class="n">ir</span><span class="o">::</span><span class="n">Sum</span><span class="o">&gt;&gt;</span> <span class="n">sum</span><span class="p">(</span><span class="o">*</span><span class="n">m</span><span class="p">,</span> <span class="s">&quot;Sum&quot;</span><span class="p">);</span>
  <span class="n">sum</span><span class="p">.</span><span class="n">def_static</span><span class="p">(</span><span class="s">&quot;make&quot;</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">ir</span><span class="o">::</span><span class="n">Sum</span><span class="o">::</span><span class="n">Make</span><span class="p">)</span>
      <span class="p">.</span><span class="n">def</span><span class="p">(</span><span class="s">&quot;operand_mutable&quot;</span><span class="p">,</span> <span class="n">py</span><span class="o">::</span><span class="n">overload_cast</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span><span class="p">(</span><span class="o">&amp;</span><span class="n">ir</span><span class="o">::</span><span class="n">Sum</span><span class="o">::</span><span class="n">operand</span><span class="p">),</span> <span class="n">py</span><span class="o">::</span><span class="n">return_value_policy</span><span class="o">::</span><span class="n">reference</span><span class="p">)</span>
      <span class="p">.</span><span class="n">def</span><span class="p">(</span><span class="s">&quot;operand_const&quot;</span><span class="p">,</span> <span class="n">py</span><span class="o">::</span><span class="n">overload_cast</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span><span class="p">(</span><span class="o">&amp;</span><span class="n">ir</span><span class="o">::</span><span class="n">Sum</span><span class="o">::</span><span class="n">operand</span><span class="p">,</span> <span class="n">py</span><span class="o">::</span><span class="n">const_</span><span class="p">),</span> <span class="n">py</span><span class="o">::</span><span class="n">return_value_policy</span><span class="o">::</span><span class="n">reference</span><span class="p">)</span>
      <span class="p">.</span><span class="n">def</span><span class="p">(</span><span class="s">&quot;type&quot;</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">ir</span><span class="o">::</span><span class="n">Sum</span><span class="o">::</span><span class="n">type</span><span class="p">);</span>

  <span class="n">DefineExprNode</span><span class="o">&lt;</span><span class="n">ir</span><span class="o">::</span><span class="n">Block</span><span class="o">&gt;</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="s">&quot;Block&quot;</span><span class="p">);</span>
  <span class="n">py</span><span class="o">::</span><span class="n">class_</span><span class="o">&lt;</span><span class="n">ir</span><span class="o">::</span><span class="n">Block</span><span class="p">,</span> <span class="n">ir</span><span class="o">::</span><span class="n">ExprNode</span><span class="o">&lt;</span><span class="n">ir</span><span class="o">::</span><span class="n">Block</span><span class="o">&gt;&gt;</span> <span class="n">block</span><span class="p">(</span><span class="o">*</span><span class="n">m</span><span class="p">,</span> <span class="s">&quot;Block&quot;</span><span class="p">);</span>
  <span class="n">block</span><span class="p">.</span><span class="n">def_readwrite</span><span class="p">(</span><span class="s">&quot;stmts&quot;</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">ir</span><span class="o">::</span><span class="n">Block</span><span class="o">::</span><span class="n">stmts</span><span class="p">)</span>
      <span class="p">.</span><span class="n">def</span><span class="p">(</span><span class="n">py</span><span class="o">::</span><span class="n">init</span><span class="o">&lt;&gt;</span><span class="p">())</span>
      <span class="p">.</span><span class="n">def_static</span><span class="p">(</span><span class="s">&quot;make&quot;</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">ir</span><span class="o">::</span><span class="n">Block</span><span class="o">::</span><span class="n">Make</span><span class="p">)</span>
      <span class="p">.</span><span class="n">def</span><span class="p">(</span><span class="s">&quot;expr_fields_mutable&quot;</span><span class="p">,</span> <span class="n">py</span><span class="o">::</span><span class="n">overload_cast</span><span class="o">&lt;&gt;</span><span class="p">(</span><span class="o">&amp;</span><span class="n">ir</span><span class="o">::</span><span class="n">Block</span><span class="o">::</span><span class="n">expr_fields</span><span class="p">))</span>
      <span class="p">.</span><span class="n">def</span><span class="p">(</span><span class="s">&quot;expr_fields_const&quot;</span><span class="p">,</span> <span class="n">py</span><span class="o">::</span><span class="n">overload_cast</span><span class="o">&lt;&gt;</span><span class="p">(</span><span class="o">&amp;</span><span class="n">ir</span><span class="o">::</span><span class="n">Block</span><span class="o">::</span><span class="n">expr_fields</span><span class="p">,</span> <span class="n">py</span><span class="o">::</span><span class="n">const_</span><span class="p">));</span>

  <span class="n">DefineExprNode</span><span class="o">&lt;</span><span class="n">ir</span><span class="o">::</span><span class="n">_Module_</span><span class="o">&gt;</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="s">&quot;_Module_&quot;</span><span class="p">);</span>
  <span class="n">py</span><span class="o">::</span><span class="n">class_</span><span class="o">&lt;</span><span class="n">ir</span><span class="o">::</span><span class="n">_Module_</span><span class="p">,</span> <span class="n">ir</span><span class="o">::</span><span class="n">ExprNode</span><span class="o">&lt;</span><span class="n">ir</span><span class="o">::</span><span class="n">_Module_</span><span class="o">&gt;&gt;</span> <span class="n">_module_</span><span class="p">(</span><span class="o">*</span><span class="n">m</span><span class="p">,</span> <span class="s">&quot;_Module_&quot;</span><span class="p">);</span>
  <span class="n">_module_</span><span class="p">.</span><span class="n">def_readwrite</span><span class="p">(</span><span class="s">&quot;name&quot;</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">ir</span><span class="o">::</span><span class="n">_Module_</span><span class="o">::</span><span class="n">name</span><span class="p">)</span>
      <span class="p">.</span><span class="n">def_readwrite</span><span class="p">(</span><span class="s">&quot;target&quot;</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">ir</span><span class="o">::</span><span class="n">_Module_</span><span class="o">::</span><span class="n">target</span><span class="p">)</span>
      <span class="p">.</span><span class="n">def_readwrite</span><span class="p">(</span><span class="s">&quot;buffers&quot;</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">ir</span><span class="o">::</span><span class="n">_Module_</span><span class="o">::</span><span class="n">buffers</span><span class="p">)</span>
      <span class="p">.</span><span class="n">def_readwrite</span><span class="p">(</span><span class="s">&quot;functions&quot;</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">ir</span><span class="o">::</span><span class="n">_Module_</span><span class="o">::</span><span class="n">functions</span><span class="p">)</span>
      <span class="p">.</span><span class="n">def_readwrite</span><span class="p">(</span><span class="s">&quot;submodules&quot;</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">ir</span><span class="o">::</span><span class="n">_Module_</span><span class="o">::</span><span class="n">submodules</span><span class="p">);</span>
<span class="p">}</span>

<span class="kt">void</span> <span class="nf">BindOperation</span><span class="p">(</span><span class="n">py</span><span class="o">::</span><span class="n">module</span> <span class="o">*</span><span class="n">m</span><span class="p">)</span> <span class="p">{</span>
  <span class="n">py</span><span class="o">::</span><span class="n">class_</span><span class="o">&lt;</span><span class="n">ir</span><span class="o">::</span><span class="n">PlaceholderOp</span> <span class="cm">/*, _Operation_Wrapper*/</span><span class="o">&gt;</span> <span class="n">placeholder_op</span><span class="p">(</span><span class="o">*</span><span class="n">m</span><span class="p">,</span> <span class="s">&quot;PlaceholderOp&quot;</span><span class="p">);</span>
  <span class="n">placeholder_op</span><span class="p">.</span><span class="n">def_readwrite</span><span class="p">(</span><span class="s">&quot;shape&quot;</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">ir</span><span class="o">::</span><span class="n">PlaceholderOp</span><span class="o">::</span><span class="n">shape</span><span class="p">)</span>
      <span class="p">.</span><span class="n">def_readwrite</span><span class="p">(</span><span class="s">&quot;dtype&quot;</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">ir</span><span class="o">::</span><span class="n">PlaceholderOp</span><span class="o">::</span><span class="n">dtype</span><span class="p">)</span>
      <span class="p">.</span><span class="n">def_static</span><span class="p">(</span><span class="s">&quot;make&quot;</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">ir</span><span class="o">::</span><span class="n">PlaceholderOp</span><span class="o">::</span><span class="n">Make</span><span class="p">)</span>
      <span class="p">.</span><span class="n">def</span><span class="p">(</span><span class="s">&quot;func_type&quot;</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">ir</span><span class="o">::</span><span class="n">PlaceholderOp</span><span class="o">::</span><span class="n">func_type</span><span class="p">);</span>

  <span class="n">py</span><span class="o">::</span><span class="n">class_</span><span class="o">&lt;</span><span class="n">ir</span><span class="o">::</span><span class="n">CallOp</span> <span class="cm">/*, _Operation_Wrapper*/</span><span class="o">&gt;</span> <span class="n">call_op</span><span class="p">(</span><span class="o">*</span><span class="n">m</span><span class="p">,</span> <span class="s">&quot;CallOp&quot;</span><span class="p">);</span>
  <span class="n">call_op</span><span class="p">.</span><span class="n">def</span><span class="p">(</span><span class="s">&quot;target&quot;</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">ir</span><span class="o">::</span><span class="n">CallOp</span><span class="o">::</span><span class="n">target</span><span class="p">)</span>
      <span class="p">.</span><span class="n">def_readwrite</span><span class="p">(</span><span class="s">&quot;call_expr&quot;</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">ir</span><span class="o">::</span><span class="n">CallOp</span><span class="o">::</span><span class="n">call_expr</span><span class="p">)</span>
      <span class="p">.</span><span class="n">def</span><span class="p">(</span><span class="s">&quot;read_args_mutable&quot;</span><span class="p">,</span> <span class="n">py</span><span class="o">::</span><span class="n">overload_cast</span><span class="o">&lt;&gt;</span><span class="p">(</span><span class="o">&amp;</span><span class="n">ir</span><span class="o">::</span><span class="n">CallOp</span><span class="o">::</span><span class="n">read_args</span><span class="p">))</span>
      <span class="p">.</span><span class="n">def</span><span class="p">(</span><span class="s">&quot;read_args_const&quot;</span><span class="p">,</span> <span class="n">py</span><span class="o">::</span><span class="n">overload_cast</span><span class="o">&lt;&gt;</span><span class="p">(</span><span class="o">&amp;</span><span class="n">ir</span><span class="o">::</span><span class="n">CallOp</span><span class="o">::</span><span class="n">read_args</span><span class="p">,</span> <span class="n">py</span><span class="o">::</span><span class="n">const_</span><span class="p">))</span>
      <span class="p">.</span><span class="n">def</span><span class="p">(</span><span class="s">&quot;write_args_mutable&quot;</span><span class="p">,</span> <span class="n">py</span><span class="o">::</span><span class="n">overload_cast</span><span class="o">&lt;&gt;</span><span class="p">(</span><span class="o">&amp;</span><span class="n">ir</span><span class="o">::</span><span class="n">CallOp</span><span class="o">::</span><span class="n">write_args</span><span class="p">))</span>
      <span class="p">.</span><span class="n">def</span><span class="p">(</span><span class="s">&quot;write_args_const&quot;</span><span class="p">,</span> <span class="n">py</span><span class="o">::</span><span class="n">overload_cast</span><span class="o">&lt;&gt;</span><span class="p">(</span><span class="o">&amp;</span><span class="n">ir</span><span class="o">::</span><span class="n">CallOp</span><span class="o">::</span><span class="n">write_args</span><span class="p">,</span> <span class="n">py</span><span class="o">::</span><span class="n">const_</span><span class="p">))</span>
      <span class="p">.</span><span class="n">def</span><span class="p">(</span><span class="s">&quot;args&quot;</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">ir</span><span class="o">::</span><span class="n">CallOp</span><span class="o">::</span><span class="n">args</span><span class="p">)</span>
      <span class="p">.</span><span class="n">def_readwrite</span><span class="p">(</span><span class="s">&quot;func&quot;</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">ir</span><span class="o">::</span><span class="n">CallOp</span><span class="o">::</span><span class="n">func</span><span class="p">)</span>
      <span class="p">.</span><span class="n">def_readwrite</span><span class="p">(</span><span class="s">&quot;value_slot&quot;</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">ir</span><span class="o">::</span><span class="n">CallOp</span><span class="o">::</span><span class="n">value_slot</span><span class="p">)</span>
      <span class="p">.</span><span class="n">def_readwrite</span><span class="p">(</span><span class="s">&quot;is_tuple_get&quot;</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">ir</span><span class="o">::</span><span class="n">CallOp</span><span class="o">::</span><span class="n">is_tuple_get</span><span class="p">)</span>
      <span class="p">.</span><span class="n">def_readwrite</span><span class="p">(</span><span class="s">&quot;num_value_slots&quot;</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">ir</span><span class="o">::</span><span class="n">CallOp</span><span class="o">::</span><span class="n">num_value_slots</span><span class="p">)</span>
      <span class="p">.</span><span class="n">def</span><span class="p">(</span><span class="n">py</span><span class="o">::</span><span class="n">init</span><span class="o">&lt;&gt;</span><span class="p">())</span>
      <span class="p">.</span><span class="n">def_static</span><span class="p">(</span><span class="s">&quot;make&quot;</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">ir</span><span class="o">::</span><span class="n">CallOp</span><span class="o">::</span><span class="n">Make</span><span class="p">)</span>
      <span class="p">.</span><span class="n">def</span><span class="p">(</span><span class="s">&quot;func_type&quot;</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">ir</span><span class="o">::</span><span class="n">CallOp</span><span class="o">::</span><span class="n">func_type</span><span class="p">);</span>

  <span class="n">py</span><span class="o">::</span><span class="n">class_</span><span class="o">&lt;</span><span class="n">ir</span><span class="o">::</span><span class="n">ComputeOp</span> <span class="cm">/*, _Operation_Wrapper*/</span><span class="o">&gt;</span> <span class="n">compute_op</span><span class="p">(</span><span class="o">*</span><span class="n">m</span><span class="p">,</span> <span class="s">&quot;ComputeOp&quot;</span><span class="p">);</span>
  <span class="n">compute_op</span><span class="p">.</span><span class="n">def_readwrite</span><span class="p">(</span><span class="s">&quot;reduce_axis&quot;</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">ir</span><span class="o">::</span><span class="n">ComputeOp</span><span class="o">::</span><span class="n">reduce_axis</span><span class="p">)</span>
      <span class="p">.</span><span class="n">def_readwrite</span><span class="p">(</span><span class="s">&quot;shape&quot;</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">ir</span><span class="o">::</span><span class="n">ComputeOp</span><span class="o">::</span><span class="n">shape</span><span class="p">)</span>
      <span class="p">.</span><span class="n">def_readwrite</span><span class="p">(</span><span class="s">&quot;body&quot;</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">ir</span><span class="o">::</span><span class="n">ComputeOp</span><span class="o">::</span><span class="n">body</span><span class="p">)</span>
      <span class="p">.</span><span class="n">def_readwrite</span><span class="p">(</span><span class="s">&quot;producer_fn&quot;</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">ir</span><span class="o">::</span><span class="n">ComputeOp</span><span class="o">::</span><span class="n">producer_fn</span><span class="p">)</span>
      <span class="p">.</span><span class="n">def</span><span class="p">(</span><span class="n">py</span><span class="o">::</span><span class="n">init</span><span class="o">&lt;&gt;</span><span class="p">())</span>
      <span class="p">.</span><span class="n">def_static</span><span class="p">(</span><span class="s">&quot;make&quot;</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">ir</span><span class="o">::</span><span class="n">ComputeOp</span><span class="o">::</span><span class="n">Make</span><span class="p">)</span>
      <span class="p">.</span><span class="n">def</span><span class="p">(</span><span class="s">&quot;func_type&quot;</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">ir</span><span class="o">::</span><span class="n">ComputeOp</span><span class="o">::</span><span class="n">func_type</span><span class="p">);</span>
<span class="p">}</span>

<span class="kt">void</span> <span class="nf">BindIrTensor</span><span class="p">(</span><span class="n">py</span><span class="o">::</span><span class="n">module</span> <span class="o">*</span><span class="n">m</span><span class="p">)</span> <span class="p">{</span>
  <span class="n">py</span><span class="o">::</span><span class="n">class_</span><span class="o">&lt;</span><span class="n">ir</span><span class="o">::</span><span class="n">Tensor</span><span class="p">,</span> <span class="n">ir</span><span class="o">::</span><span class="n">IrNodeRef</span><span class="o">&gt;</span> <span class="n">tensor</span><span class="p">(</span><span class="o">*</span><span class="n">m</span><span class="p">,</span> <span class="s">&quot;Tensor&quot;</span><span class="p">);</span>
  <span class="n">tensor</span><span class="p">.</span><span class="n">def</span><span class="p">(</span><span class="n">py</span><span class="o">::</span><span class="n">init</span><span class="o">&lt;&gt;</span><span class="p">())</span>
      <span class="p">.</span><span class="n">def</span><span class="p">(</span><span class="n">py</span><span class="o">::</span><span class="n">init</span><span class="o">&lt;</span><span class="n">ir</span><span class="o">::</span><span class="n">IrNode</span> <span class="o">*&gt;</span><span class="p">())</span>
      <span class="p">.</span><span class="n">def</span><span class="p">(</span><span class="s">&quot;ndims&quot;</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">ir</span><span class="o">::</span><span class="n">Tensor</span><span class="o">::</span><span class="n">ndims</span><span class="p">)</span>
      <span class="p">.</span><span class="n">def</span><span class="p">(</span><span class="s">&quot;__call__&quot;</span><span class="p">,</span> <span class="p">[](</span><span class="n">ir</span><span class="o">::</span><span class="n">Tensor</span> <span class="o">&amp;</span><span class="n">self</span><span class="p">,</span> <span class="n">Expr</span> <span class="n">a</span><span class="p">)</span> <span class="p">{</span> <span class="k">return</span> <span class="n">self</span><span class="p">(</span><span class="n">a</span><span class="p">);</span> <span class="p">})</span>
      <span class="p">.</span><span class="n">def</span><span class="p">(</span><span class="s">&quot;__call__&quot;</span><span class="p">,</span> <span class="p">[](</span><span class="n">ir</span><span class="o">::</span><span class="n">Tensor</span> <span class="o">&amp;</span><span class="n">self</span><span class="p">,</span> <span class="n">Expr</span> <span class="n">a</span><span class="p">,</span> <span class="n">Expr</span> <span class="n">b</span><span class="p">)</span> <span class="p">{</span> <span class="k">return</span> <span class="n">self</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">);</span> <span class="p">})</span>
      <span class="p">.</span><span class="n">def</span><span class="p">(</span><span class="s">&quot;__call__&quot;</span><span class="p">,</span> <span class="p">[](</span><span class="n">ir</span><span class="o">::</span><span class="n">Tensor</span> <span class="o">&amp;</span><span class="n">self</span><span class="p">,</span> <span class="n">Expr</span> <span class="n">a</span><span class="p">,</span> <span class="n">Expr</span> <span class="n">b</span><span class="p">,</span> <span class="n">Expr</span> <span class="n">c</span><span class="p">)</span> <span class="p">{</span> <span class="k">return</span> <span class="n">self</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">);</span> <span class="p">})</span>
      <span class="p">.</span><span class="n">def</span><span class="p">(</span><span class="s">&quot;__call__&quot;</span><span class="p">,</span> <span class="p">[](</span><span class="n">ir</span><span class="o">::</span><span class="n">Tensor</span> <span class="o">&amp;</span><span class="n">self</span><span class="p">,</span> <span class="n">Expr</span> <span class="n">a</span><span class="p">,</span> <span class="n">Expr</span> <span class="n">b</span><span class="p">,</span> <span class="n">Expr</span> <span class="n">c</span><span class="p">,</span> <span class="n">Expr</span> <span class="n">d</span><span class="p">)</span> <span class="p">{</span> <span class="k">return</span> <span class="n">self</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">d</span><span class="p">);</span> <span class="p">});</span>

  <span class="n">DefineExprNode</span><span class="o">&lt;</span><span class="n">ir</span><span class="o">::</span><span class="n">_Tensor_</span><span class="o">&gt;</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="s">&quot;_Tensor_&quot;</span><span class="p">);</span>
  <span class="n">py</span><span class="o">::</span><span class="n">class_</span><span class="o">&lt;</span><span class="n">ir</span><span class="o">::</span><span class="n">_Tensor_</span><span class="p">,</span> <span class="n">ir</span><span class="o">::</span><span class="n">ExprNode</span><span class="o">&lt;</span><span class="n">ir</span><span class="o">::</span><span class="n">_Tensor_</span><span class="o">&gt;&gt;</span> <span class="n">_tensor_</span><span class="p">(</span><span class="o">*</span><span class="n">m</span><span class="p">,</span> <span class="s">&quot;_Tensor_&quot;</span><span class="p">);</span>
  <span class="n">_tensor_</span><span class="p">.</span><span class="n">def_readwrite</span><span class="p">(</span><span class="s">&quot;shape&quot;</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">ir</span><span class="o">::</span><span class="n">_Tensor_</span><span class="o">::</span><span class="n">shape</span><span class="p">)</span>
      <span class="p">.</span><span class="n">def_readwrite</span><span class="p">(</span><span class="s">&quot;reduce_axis&quot;</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">ir</span><span class="o">::</span><span class="n">_Tensor_</span><span class="o">::</span><span class="n">reduce_axis</span><span class="p">)</span>
      <span class="p">.</span><span class="n">def_readwrite</span><span class="p">(</span><span class="s">&quot;operation&quot;</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">ir</span><span class="o">::</span><span class="n">_Tensor_</span><span class="o">::</span><span class="n">operation</span><span class="p">)</span>
      <span class="p">.</span><span class="n">def_readwrite</span><span class="p">(</span><span class="s">&quot;name&quot;</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">ir</span><span class="o">::</span><span class="n">_Tensor_</span><span class="o">::</span><span class="n">name</span><span class="p">)</span>
      <span class="p">.</span><span class="n">def_readwrite</span><span class="p">(</span><span class="s">&quot;buffer&quot;</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">ir</span><span class="o">::</span><span class="n">_Tensor_</span><span class="o">::</span><span class="n">buffer</span><span class="p">)</span>
      <span class="p">.</span><span class="n">def</span><span class="p">(</span><span class="s">&quot;domain_with_reduce_axis&quot;</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">ir</span><span class="o">::</span><span class="n">_Tensor_</span><span class="o">::</span><span class="n">domain_without_reduce_axis</span><span class="p">)</span>
      <span class="p">.</span><span class="n">def</span><span class="p">(</span><span class="s">&quot;domain_without_reduce_axis&quot;</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">ir</span><span class="o">::</span><span class="n">_Tensor_</span><span class="o">::</span><span class="n">domain_without_reduce_axis</span><span class="p">)</span>
      <span class="p">.</span><span class="n">def_static</span><span class="p">(</span><span class="s">&quot;make&quot;</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">ir</span><span class="o">::</span><span class="n">_Tensor_</span><span class="o">::</span><span class="n">Make</span><span class="p">)</span>
      <span class="p">.</span><span class="n">def</span><span class="p">(</span><span class="s">&quot;is_tuple&quot;</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">ir</span><span class="o">::</span><span class="n">_Tensor_</span><span class="o">::</span><span class="n">is_tuple</span><span class="p">)</span>
      <span class="p">.</span><span class="n">def</span><span class="p">(</span><span class="s">&quot;is_tuple_get&quot;</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">ir</span><span class="o">::</span><span class="n">_Tensor_</span><span class="o">::</span><span class="n">is_tuple_get</span><span class="p">)</span>
      <span class="p">.</span><span class="n">def</span><span class="p">(</span><span class="s">&quot;tuple_get&quot;</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">ir</span><span class="o">::</span><span class="n">_Tensor_</span><span class="o">::</span><span class="n">TupleGet</span><span class="p">)</span>
      <span class="p">.</span><span class="n">def</span><span class="p">(</span><span class="s">&quot;get_depend_tensor_names&quot;</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">ir</span><span class="o">::</span><span class="n">_Tensor_</span><span class="o">::</span><span class="n">GetDependTensorNames</span><span class="p">)</span>
      <span class="p">.</span><span class="n">def</span><span class="p">(</span><span class="s">&quot;is_depend_on_statement&quot;</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">ir</span><span class="o">::</span><span class="n">_Tensor_</span><span class="o">::</span><span class="n">IsDependOnStatement</span><span class="p">)</span>
      <span class="p">.</span><span class="n">def</span><span class="p">(</span><span class="s">&quot;depending_tensor_names&quot;</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">ir</span><span class="o">::</span><span class="n">_Tensor_</span><span class="o">::</span><span class="n">DependingTensorNames</span><span class="p">)</span>
      <span class="p">.</span><span class="n">def</span><span class="p">(</span><span class="s">&quot;same_shape_with&quot;</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">ir</span><span class="o">::</span><span class="n">_Tensor_</span><span class="o">::</span><span class="n">HasSameShapeWith</span><span class="p">)</span>
      <span class="p">.</span><span class="n">def</span><span class="p">(</span><span class="s">&quot;is_compute_node&quot;</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">ir</span><span class="o">::</span><span class="n">_Tensor_</span><span class="o">::</span><span class="n">is_compute_node</span><span class="p">)</span>
      <span class="p">.</span><span class="n">def</span><span class="p">(</span><span class="s">&quot;is_placeholder_node&quot;</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">ir</span><span class="o">::</span><span class="n">_Tensor_</span><span class="o">::</span><span class="n">is_placeholder_node</span><span class="p">)</span>
      <span class="p">.</span><span class="n">def</span><span class="p">(</span><span class="s">&quot;is_call_node&quot;</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">ir</span><span class="o">::</span><span class="n">_Tensor_</span><span class="o">::</span><span class="n">is_call_node</span><span class="p">)</span>
      <span class="p">.</span><span class="n">def</span><span class="p">(</span><span class="s">&quot;is_extern_call_node&quot;</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">ir</span><span class="o">::</span><span class="n">_Tensor_</span><span class="o">::</span><span class="n">is_extern_call_node</span><span class="p">)</span>
      <span class="p">.</span><span class="n">def</span><span class="p">(</span><span class="s">&quot;is_preceding_view_node&quot;</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">ir</span><span class="o">::</span><span class="n">_Tensor_</span><span class="o">::</span><span class="n">is_preceding_view_node</span><span class="p">)</span>
      <span class="p">.</span><span class="n">def</span><span class="p">(</span><span class="s">&quot;is_buffer_shared_node&quot;</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">ir</span><span class="o">::</span><span class="n">_Tensor_</span><span class="o">::</span><span class="n">is_buffer_shared_node</span><span class="p">)</span>
      <span class="p">.</span><span class="n">def</span><span class="p">(</span><span class="s">&quot;operation_type&quot;</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">ir</span><span class="o">::</span><span class="n">_Tensor_</span><span class="o">::</span><span class="n">operation_type</span><span class="p">)</span>
      <span class="p">.</span><span class="n">def</span><span class="p">(</span><span class="s">&quot;get_compute_op&quot;</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">ir</span><span class="o">::</span><span class="n">_Tensor_</span><span class="o">::</span><span class="n">get_compute_op</span><span class="p">)</span>
      <span class="p">.</span><span class="n">def</span><span class="p">(</span><span class="s">&quot;get_placeholder_op&quot;</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">ir</span><span class="o">::</span><span class="n">_Tensor_</span><span class="o">::</span><span class="n">get_placeholder_op</span><span class="p">)</span>
      <span class="p">.</span><span class="n">def</span><span class="p">(</span><span class="s">&quot;body&quot;</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">ir</span><span class="o">::</span><span class="n">_Tensor_</span><span class="o">::</span><span class="n">body</span><span class="p">)</span>
      <span class="p">.</span><span class="n">def</span><span class="p">(</span><span class="s">&quot;tensor_store_expanded_body&quot;</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">ir</span><span class="o">::</span><span class="n">_Tensor_</span><span class="o">::</span><span class="n">tensor_store_expanded_body</span><span class="p">)</span>
      <span class="p">.</span><span class="n">def</span><span class="p">(</span><span class="s">&quot;inline_expanded&quot;</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">ir</span><span class="o">::</span><span class="n">_Tensor_</span><span class="o">::</span><span class="n">inline_expanded</span><span class="p">)</span>
      <span class="p">.</span><span class="n">def</span><span class="p">(</span><span class="s">&quot;contains_reduce_axis&quot;</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">ir</span><span class="o">::</span><span class="n">_Tensor_</span><span class="o">::</span><span class="n">contains_reduce_axis</span><span class="p">)</span>
      <span class="p">.</span><span class="n">def</span><span class="p">(</span><span class="s">&quot;expr_fields_mutable&quot;</span><span class="p">,</span> <span class="n">py</span><span class="o">::</span><span class="n">overload_cast</span><span class="o">&lt;&gt;</span><span class="p">(</span><span class="o">&amp;</span><span class="n">ir</span><span class="o">::</span><span class="n">_Tensor_</span><span class="o">::</span><span class="n">expr_fields</span><span class="p">))</span>
      <span class="p">.</span><span class="n">def</span><span class="p">(</span><span class="s">&quot;expr_fields_const&quot;</span><span class="p">,</span> <span class="n">py</span><span class="o">::</span><span class="n">overload_cast</span><span class="o">&lt;&gt;</span><span class="p">(</span><span class="o">&amp;</span><span class="n">ir</span><span class="o">::</span><span class="n">_Tensor_</span><span class="o">::</span><span class="n">expr_fields</span><span class="p">,</span> <span class="n">py</span><span class="o">::</span><span class="n">const_</span><span class="p">))</span>
      <span class="p">.</span><span class="n">def</span><span class="p">(</span><span class="s">&quot;axis&quot;</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">ir</span><span class="o">::</span><span class="n">_Tensor_</span><span class="o">::</span><span class="n">axis</span><span class="p">)</span>
      <span class="p">.</span><span class="n">def</span><span class="p">(</span><span class="s">&quot;axis_with_reduce&quot;</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">ir</span><span class="o">::</span><span class="n">_Tensor_</span><span class="o">::</span><span class="n">axis_with_reduce</span><span class="p">)</span>
      <span class="p">.</span><span class="n">def</span><span class="p">(</span><span class="s">&quot;buffer_depended_tensor_names&quot;</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">ir</span><span class="o">::</span><span class="n">_Tensor_</span><span class="o">::</span><span class="n">buffer_depended_tensor_names</span><span class="p">)</span>
      <span class="p">.</span><span class="n">def</span><span class="p">(</span><span class="n">py</span><span class="o">::</span><span class="n">init</span><span class="o">&lt;&gt;</span><span class="p">())</span>
      <span class="p">.</span><span class="n">def</span><span class="p">(</span><span class="s">&quot;has_expression&quot;</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">ir</span><span class="o">::</span><span class="n">_Tensor_</span><span class="o">::</span><span class="n">has_expression</span><span class="p">)</span>
      <span class="p">.</span><span class="n">def</span><span class="p">(</span><span class="s">&quot;reshape&quot;</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">ir</span><span class="o">::</span><span class="n">_Tensor_</span><span class="o">::</span><span class="n">Reshape</span><span class="p">)</span>
      <span class="p">.</span><span class="n">def</span><span class="p">(</span><span class="s">&quot;reshape_copied&quot;</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">ir</span><span class="o">::</span><span class="n">_Tensor_</span><span class="o">::</span><span class="n">ReshapeCopied</span><span class="p">)</span>
      <span class="p">.</span><span class="n">def</span><span class="p">(</span><span class="s">&quot;with_buffer&quot;</span><span class="p">,</span>
           <span class="n">py</span><span class="o">::</span><span class="n">overload_cast</span><span class="o">&lt;</span><span class="k">const</span> <span class="n">ir</span><span class="o">::</span><span class="n">Type</span> <span class="o">&amp;&gt;</span><span class="p">(</span><span class="o">&amp;</span><span class="n">ir</span><span class="o">::</span><span class="n">_Tensor_</span><span class="o">::</span><span class="n">WithBuffer</span><span class="p">),</span>
           <span class="n">py</span><span class="o">::</span><span class="n">arg</span><span class="p">(</span><span class="s">&quot;type&quot;</span><span class="p">)</span> <span class="o">=</span> <span class="n">Type</span><span class="o">::</span><span class="n">type_t</span><span class="o">::</span><span class="n">Void</span><span class="p">)</span>
      <span class="p">.</span><span class="n">def</span><span class="p">(</span><span class="s">&quot;with_buffer&quot;</span><span class="p">,</span>
           <span class="n">py</span><span class="o">::</span><span class="n">overload_cast</span><span class="o">&lt;</span><span class="k">const</span> <span class="n">std</span><span class="o">::</span><span class="n">string</span> <span class="o">&amp;</span><span class="p">,</span> <span class="k">const</span> <span class="n">ir</span><span class="o">::</span><span class="n">Type</span> <span class="o">&amp;&gt;</span><span class="p">(</span><span class="o">&amp;</span><span class="n">ir</span><span class="o">::</span><span class="n">_Tensor_</span><span class="o">::</span><span class="n">WithBuffer</span><span class="p">),</span>
           <span class="n">py</span><span class="o">::</span><span class="n">arg</span><span class="p">(</span><span class="s">&quot;memory_type&quot;</span><span class="p">),</span>
           <span class="n">py</span><span class="o">::</span><span class="n">arg</span><span class="p">(</span><span class="s">&quot;type&quot;</span><span class="p">)</span> <span class="o">=</span> <span class="n">Type</span><span class="o">::</span><span class="n">type_t</span><span class="o">::</span><span class="n">Void</span><span class="p">)</span>
      <span class="p">.</span><span class="n">def</span><span class="p">(</span><span class="s">&quot;bind&quot;</span><span class="p">,</span> <span class="n">py</span><span class="o">::</span><span class="n">overload_cast</span><span class="o">&lt;</span><span class="n">lang</span><span class="o">::</span><span class="n">Buffer</span> <span class="o">&amp;&gt;</span><span class="p">(</span><span class="o">&amp;</span><span class="n">ir</span><span class="o">::</span><span class="n">_Tensor_</span><span class="o">::</span><span class="n">Bind</span><span class="p">))</span>
      <span class="p">.</span><span class="n">def</span><span class="p">(</span><span class="s">&quot;bind&quot;</span><span class="p">,</span> <span class="n">py</span><span class="o">::</span><span class="n">overload_cast</span><span class="o">&lt;</span><span class="k">const</span> <span class="n">ir</span><span class="o">::</span><span class="n">Buffer</span> <span class="o">&amp;&gt;</span><span class="p">(</span><span class="o">&amp;</span><span class="n">ir</span><span class="o">::</span><span class="n">_Tensor_</span><span class="o">::</span><span class="n">Bind</span><span class="p">))</span>
      <span class="p">.</span><span class="n">def</span><span class="p">(</span><span class="s">&quot;__str__&quot;</span><span class="p">,</span> <span class="p">[](</span><span class="k">const</span> <span class="n">ir</span><span class="o">::</span><span class="n">Tensor</span> <span class="o">&amp;</span><span class="n">self</span><span class="p">)</span> <span class="p">{</span> <span class="k">return</span> <span class="s">&quot;&lt;Tensor &quot;</span> <span class="o">+</span> <span class="n">self</span><span class="o">-&gt;</span><span class="n">name</span> <span class="o">+</span> <span class="s">&quot;&gt;&quot;</span><span class="p">;</span> <span class="p">});</span>

  <span class="n">py</span><span class="o">::</span><span class="n">class_</span><span class="o">&lt;</span><span class="n">ir</span><span class="o">::</span><span class="n">Operation</span> <span class="cm">/*, ir::FunctionDef*/</span><span class="o">&gt;</span> <span class="n">operation</span><span class="p">(</span><span class="o">*</span><span class="n">m</span><span class="p">,</span> <span class="s">&quot;Operation&quot;</span><span class="p">);</span>
  <span class="n">operation</span><span class="p">.</span><span class="n">def</span><span class="p">(</span><span class="n">py</span><span class="o">::</span><span class="n">init</span><span class="o">&lt;&gt;</span><span class="p">()).</span><span class="n">def</span><span class="p">(</span><span class="n">py</span><span class="o">::</span><span class="n">init</span><span class="o">&lt;</span><span class="n">ir</span><span class="o">::</span><span class="n">IrNode</span> <span class="o">*&gt;</span><span class="p">()).</span><span class="n">def_readwrite</span><span class="p">(</span><span class="s">&quot;name&quot;</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">ir</span><span class="o">::</span><span class="n">Operation</span><span class="o">::</span><span class="n">name</span><span class="p">);</span>
<span class="p">}</span>

<span class="k">auto</span> <span class="nf">PackedFuncCall</span><span class="p">(</span><span class="n">lang</span><span class="o">::</span><span class="n">PackedFunc</span> <span class="o">&amp;</span><span class="n">self</span><span class="p">,</span> <span class="n">py</span><span class="o">::</span><span class="n">args</span> <span class="n">args</span><span class="p">)</span> <span class="p">{</span>  <span class="c1">// NOLINT</span>
  <span class="n">lang</span><span class="o">::</span><span class="n">Args</span> <span class="n">cinn_args</span><span class="p">;</span>
  <span class="k">using</span> <span class="n">common</span><span class="o">::</span><span class="n">CINNValue</span><span class="p">;</span>
  <span class="k">for</span> <span class="p">(</span><span class="k">auto</span> <span class="nl">handle</span> <span class="p">:</span> <span class="n">args</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">py</span><span class="o">::</span><span class="n">isinstance</span><span class="o">&lt;</span><span class="n">py</span><span class="o">::</span><span class="n">int_</span><span class="o">&gt;</span><span class="p">(</span><span class="n">handle</span><span class="p">))</span> <span class="p">{</span>
      <span class="n">cinn_args</span><span class="p">.</span><span class="n">Append</span><span class="p">(</span><span class="n">CINNValue</span><span class="p">(</span><span class="n">py</span><span class="o">::</span><span class="n">cast</span><span class="o">&lt;</span><span class="kt">int64_t</span><span class="o">&gt;</span><span class="p">(</span><span class="n">handle</span><span class="p">)));</span>
    <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="n">py</span><span class="o">::</span><span class="n">isinstance</span><span class="o">&lt;</span><span class="n">py</span><span class="o">::</span><span class="n">float_</span><span class="o">&gt;</span><span class="p">(</span><span class="n">handle</span><span class="p">))</span> <span class="p">{</span>
      <span class="n">cinn_args</span><span class="p">.</span><span class="n">Append</span><span class="p">(</span><span class="n">CINNValue</span><span class="p">(</span><span class="n">py</span><span class="o">::</span><span class="n">cast</span><span class="o">&lt;</span><span class="kt">float</span><span class="o">&gt;</span><span class="p">(</span><span class="n">handle</span><span class="p">)));</span>
    <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="n">py</span><span class="o">::</span><span class="n">isinstance</span><span class="o">&lt;</span><span class="n">ir</span><span class="o">::</span><span class="n">Var</span><span class="o">&gt;</span><span class="p">(</span><span class="n">handle</span><span class="p">))</span> <span class="p">{</span>
      <span class="n">cinn_args</span><span class="p">.</span><span class="n">Append</span><span class="p">(</span><span class="n">CINNValue</span><span class="p">(</span><span class="n">py</span><span class="o">::</span><span class="n">cast</span><span class="o">&lt;</span><span class="n">ir</span><span class="o">::</span><span class="n">Var</span><span class="o">&gt;</span><span class="p">(</span><span class="n">handle</span><span class="p">)));</span>
    <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="n">py</span><span class="o">::</span><span class="n">isinstance</span><span class="o">&lt;</span><span class="n">ir</span><span class="o">::</span><span class="n">Expr</span><span class="o">&gt;</span><span class="p">(</span><span class="n">handle</span><span class="p">))</span> <span class="p">{</span>
      <span class="n">cinn_args</span><span class="p">.</span><span class="n">Append</span><span class="p">(</span><span class="n">CINNValue</span><span class="p">(</span><span class="n">py</span><span class="o">::</span><span class="n">cast</span><span class="o">&lt;</span><span class="n">ir</span><span class="o">::</span><span class="n">Expr</span><span class="o">&gt;</span><span class="p">(</span><span class="n">handle</span><span class="p">)));</span>
    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
      <span class="n">LOG</span><span class="p">(</span><span class="n">FATAL</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;unsupported type: &quot;</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="p">(</span><span class="n">py</span><span class="o">::</span><span class="n">str</span><span class="p">(</span><span class="n">handle</span><span class="p">.</span><span class="n">get_type</span><span class="p">()));</span>
    <span class="p">}</span>
  <span class="p">}</span>
  <span class="n">lang</span><span class="o">::</span><span class="n">RetValue</span> <span class="n">ret_value</span><span class="p">;</span>
  <span class="n">self</span><span class="p">.</span><span class="n">body</span><span class="p">()(</span><span class="n">cinn_args</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">ret_value</span><span class="p">);</span>
  <span class="k">return</span> <span class="n">ConvertToVar</span><span class="p">(</span><span class="n">ret_value</span><span class="p">);</span>
<span class="p">}</span>

<span class="kt">void</span> <span class="nf">BindPackedFunc</span><span class="p">(</span><span class="n">py</span><span class="o">::</span><span class="n">module</span> <span class="o">*</span><span class="n">m</span><span class="p">)</span> <span class="p">{</span>
  <span class="n">py</span><span class="o">::</span><span class="n">class_</span><span class="o">&lt;</span><span class="n">lang</span><span class="o">::</span><span class="n">Args</span><span class="o">&gt;</span> <span class="n">args</span><span class="p">(</span><span class="o">*</span><span class="n">m</span><span class="p">,</span> <span class="s">&quot;Args&quot;</span><span class="p">);</span>
  <span class="n">args</span><span class="p">.</span><span class="n">def</span><span class="p">(</span><span class="n">py</span><span class="o">::</span><span class="n">init</span><span class="o">&lt;&gt;</span><span class="p">())</span>
      <span class="p">.</span><span class="n">def</span><span class="p">(</span><span class="n">py</span><span class="o">::</span><span class="n">init</span><span class="o">&lt;</span><span class="n">cinn_value_t</span> <span class="o">*</span><span class="p">,</span> <span class="kt">int</span> <span class="o">*</span><span class="p">,</span> <span class="kt">int</span><span class="o">&gt;</span><span class="p">())</span>
      <span class="p">.</span><span class="n">def</span><span class="p">(</span><span class="s">&quot;append&quot;</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">lang</span><span class="o">::</span><span class="n">Args</span><span class="o">::</span><span class="n">Append</span><span class="p">)</span>
      <span class="p">.</span><span class="n">def</span><span class="p">(</span><span class="s">&quot;size&quot;</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">lang</span><span class="o">::</span><span class="n">Args</span><span class="o">::</span><span class="n">size</span><span class="p">)</span>
      <span class="p">.</span><span class="n">def</span><span class="p">(</span><span class="s">&quot;__len__&quot;</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">lang</span><span class="o">::</span><span class="n">Args</span><span class="o">::</span><span class="n">size</span><span class="p">)</span>
      <span class="p">.</span><span class="n">def</span><span class="p">(</span>
          <span class="s">&quot;__getitem__&quot;</span><span class="p">,</span> <span class="p">[](</span><span class="n">lang</span><span class="o">::</span><span class="n">Args</span> <span class="o">&amp;</span><span class="n">self</span><span class="p">,</span> <span class="kt">int</span> <span class="n">i</span><span class="p">)</span> <span class="p">{</span> <span class="k">return</span> <span class="n">self</span><span class="p">[</span><span class="n">i</span><span class="p">];</span> <span class="p">},</span> <span class="n">py</span><span class="o">::</span><span class="n">return_value_policy</span><span class="o">::</span><span class="n">reference</span><span class="p">)</span>
      <span class="p">.</span><span class="n">def</span><span class="p">(</span><span class="s">&quot;__setitem__&quot;</span><span class="p">,</span> <span class="p">[](</span><span class="n">lang</span><span class="o">::</span><span class="n">Args</span> <span class="o">&amp;</span><span class="n">self</span><span class="p">,</span> <span class="kt">int</span> <span class="n">i</span><span class="p">,</span> <span class="n">common</span><span class="o">::</span><span class="n">CINNValue</span> <span class="o">&amp;</span><span class="n">v</span><span class="p">)</span> <span class="p">{</span> <span class="n">self</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">v</span><span class="p">;</span> <span class="p">});</span>

  <span class="n">py</span><span class="o">::</span><span class="n">class_</span><span class="o">&lt;</span><span class="n">lang</span><span class="o">::</span><span class="n">PackedFunc</span><span class="o">&gt;</span> <span class="n">packed_func</span><span class="p">(</span><span class="o">*</span><span class="n">m</span><span class="p">,</span> <span class="s">&quot;PackedFunc&quot;</span><span class="p">);</span>
  <span class="n">packed_func</span><span class="p">.</span><span class="n">def</span><span class="p">(</span><span class="n">py</span><span class="o">::</span><span class="n">init</span><span class="o">&lt;&gt;</span><span class="p">())</span>
      <span class="p">.</span><span class="n">def</span><span class="p">(</span><span class="n">py</span><span class="o">::</span><span class="n">init</span><span class="o">&lt;</span><span class="k">const</span> <span class="n">std</span><span class="o">::</span><span class="n">string</span> <span class="o">&amp;&gt;</span><span class="p">())</span>
      <span class="p">.</span><span class="n">def</span><span class="p">(</span><span class="n">py</span><span class="o">::</span><span class="n">init</span><span class="o">&lt;</span><span class="n">lang</span><span class="o">::</span><span class="n">PackedFunc</span><span class="o">::</span><span class="n">body_t</span><span class="o">&gt;</span><span class="p">())</span>
      <span class="p">.</span><span class="n">def</span><span class="p">(</span><span class="s">&quot;body&quot;</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">lang</span><span class="o">::</span><span class="n">PackedFunc</span><span class="o">::</span><span class="n">body</span><span class="p">)</span>
      <span class="p">.</span><span class="n">def</span><span class="p">(</span><span class="s">&quot;__call__&quot;</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">PackedFuncCall</span><span class="p">);</span>
<span class="p">}</span>

<span class="kt">void</span> <span class="nf">BindRegistry</span><span class="p">(</span><span class="n">py</span><span class="o">::</span><span class="n">module</span> <span class="o">*</span><span class="n">m</span><span class="p">)</span> <span class="p">{</span>
  <span class="n">py</span><span class="o">::</span><span class="n">class_</span><span class="o">&lt;</span><span class="n">ir</span><span class="o">::</span><span class="n">Registry</span><span class="o">&gt;</span> <span class="n">registry</span><span class="p">(</span><span class="o">*</span><span class="n">m</span><span class="p">,</span> <span class="s">&quot;Registry&quot;</span><span class="p">);</span>
  <span class="n">registry</span>
      <span class="p">.</span><span class="n">def_static</span><span class="p">(</span><span class="s">&quot;register&quot;</span><span class="p">,</span>
                  <span class="o">&amp;</span><span class="n">ir</span><span class="o">::</span><span class="n">Registry</span><span class="o">::</span><span class="n">Register</span><span class="p">,</span>
                  <span class="n">py</span><span class="o">::</span><span class="n">arg</span><span class="p">(</span><span class="s">&quot;name&quot;</span><span class="p">),</span>
                  <span class="n">py</span><span class="o">::</span><span class="n">arg</span><span class="p">(</span><span class="s">&quot;override&quot;</span><span class="p">)</span> <span class="o">=</span> <span class="nb">false</span><span class="p">,</span>
                  <span class="n">py</span><span class="o">::</span><span class="n">return_value_policy</span><span class="o">::</span><span class="n">reference</span><span class="p">)</span>
      <span class="p">.</span><span class="n">def_static</span><span class="p">(</span><span class="s">&quot;register&quot;</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">ir</span><span class="o">::</span><span class="n">Registry</span><span class="o">::</span><span class="n">Register</span><span class="p">,</span> <span class="n">py</span><span class="o">::</span><span class="n">return_value_policy</span><span class="o">::</span><span class="n">reference</span><span class="p">)</span>
      <span class="p">.</span><span class="n">def_static</span><span class="p">(</span><span class="s">&quot;remove&quot;</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">ir</span><span class="o">::</span><span class="n">Registry</span><span class="o">::</span><span class="n">Remove</span><span class="p">)</span>
      <span class="p">.</span><span class="n">def_static</span><span class="p">(</span><span class="s">&quot;get&quot;</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">ir</span><span class="o">::</span><span class="n">Registry</span><span class="o">::</span><span class="n">Get</span><span class="p">,</span> <span class="n">py</span><span class="o">::</span><span class="n">return_value_policy</span><span class="o">::</span><span class="n">reference</span><span class="p">)</span>
      <span class="p">.</span><span class="n">def_static</span><span class="p">(</span><span class="s">&quot;list_names&quot;</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">ir</span><span class="o">::</span><span class="n">Registry</span><span class="o">::</span><span class="n">ListNames</span><span class="p">)</span>
      <span class="p">.</span><span class="n">def</span><span class="p">(</span><span class="s">&quot;set_body&quot;</span><span class="p">,</span> <span class="n">py</span><span class="o">::</span><span class="n">overload_cast</span><span class="o">&lt;</span><span class="n">lang</span><span class="o">::</span><span class="n">PackedFunc</span><span class="o">&gt;</span><span class="p">(</span><span class="o">&amp;</span><span class="n">ir</span><span class="o">::</span><span class="n">Registry</span><span class="o">::</span><span class="n">SetBody</span><span class="p">),</span> <span class="n">py</span><span class="o">::</span><span class="n">return_value_policy</span><span class="o">::</span><span class="n">reference</span><span class="p">);</span>

<span class="cp">#ifdef CINN_WITH_TEST</span>
  <span class="n">ir</span><span class="o">::</span><span class="n">Registry</span><span class="o">::</span><span class="n">Register</span><span class="p">(</span><span class="s">&quot;test_add_int64&quot;</span><span class="p">).</span><span class="n">SetBody</span><span class="p">([](</span><span class="n">lang</span><span class="o">::</span><span class="n">Args</span> <span class="n">args</span><span class="p">,</span> <span class="n">lang</span><span class="o">::</span><span class="n">RetValue</span> <span class="o">*</span><span class="n">rv</span><span class="p">)</span> <span class="p">{</span>
    <span class="kt">int64_t</span> <span class="n">x</span> <span class="o">=</span> <span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
    <span class="kt">int64_t</span> <span class="n">y</span> <span class="o">=</span> <span class="n">args</span><span class="p">[</span><span class="mi">1</span><span class="p">];</span>
    <span class="o">*</span><span class="n">rv</span>       <span class="o">=</span> <span class="n">x</span> <span class="o">+</span> <span class="n">y</span><span class="p">;</span>
  <span class="p">});</span>

  <span class="n">ir</span><span class="o">::</span><span class="n">Registry</span><span class="o">::</span><span class="n">Register</span><span class="p">(</span><span class="s">&quot;test_add_expr&quot;</span><span class="p">).</span><span class="n">SetBody</span><span class="p">([](</span><span class="n">lang</span><span class="o">::</span><span class="n">Args</span> <span class="n">args</span><span class="p">,</span> <span class="n">lang</span><span class="o">::</span><span class="n">RetValue</span> <span class="o">*</span><span class="n">rv</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">ir</span><span class="o">::</span><span class="n">Expr</span> <span class="n">x</span> <span class="o">=</span> <span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
    <span class="n">ir</span><span class="o">::</span><span class="n">Expr</span> <span class="n">y</span> <span class="o">=</span> <span class="n">args</span><span class="p">[</span><span class="mi">1</span><span class="p">];</span>
    <span class="o">*</span><span class="n">rv</span>        <span class="o">=</span> <span class="n">x</span> <span class="o">+</span> <span class="n">y</span><span class="p">;</span>
  <span class="p">});</span>

  <span class="n">ir</span><span class="o">::</span><span class="n">Registry</span><span class="o">::</span><span class="n">Register</span><span class="p">(</span><span class="s">&quot;test_mul_float&quot;</span><span class="p">).</span><span class="n">SetBody</span><span class="p">([](</span><span class="n">lang</span><span class="o">::</span><span class="n">Args</span> <span class="n">args</span><span class="p">,</span> <span class="n">lang</span><span class="o">::</span><span class="n">RetValue</span> <span class="o">*</span><span class="n">rv</span><span class="p">)</span> <span class="p">{</span>
    <span class="kt">float</span> <span class="n">x</span> <span class="o">=</span> <span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
    <span class="kt">float</span> <span class="n">y</span> <span class="o">=</span> <span class="n">args</span><span class="p">[</span><span class="mi">1</span><span class="p">];</span>
    <span class="o">*</span><span class="n">rv</span>     <span class="o">=</span> <span class="n">x</span> <span class="o">*</span> <span class="n">y</span><span class="p">;</span>
  <span class="p">});</span>
<span class="cp">#endif</span>
<span class="p">}</span>
<span class="p">}</span>  <span class="c1">// namespace</span>

<span class="kt">void</span> <span class="n">BindIr</span><span class="p">(</span><span class="n">py</span><span class="o">::</span><span class="n">module</span> <span class="o">*</span><span class="n">m</span><span class="p">)</span> <span class="p">{</span>
  <span class="n">BindOperation</span><span class="p">(</span><span class="n">m</span><span class="p">);</span>
  <span class="n">BindLoweredFunc</span><span class="p">(</span><span class="n">m</span><span class="p">);</span>
  <span class="n">BindNode</span><span class="p">(</span><span class="n">m</span><span class="p">);</span>
  <span class="n">BindIrVisitor</span><span class="p">(</span><span class="n">m</span><span class="p">);</span>
  <span class="n">BindIrIr</span><span class="p">(</span><span class="n">m</span><span class="p">);</span>
  <span class="n">BindIrTensor</span><span class="p">(</span><span class="n">m</span><span class="p">);</span>
  <span class="n">BindPackedFunc</span><span class="p">(</span><span class="n">m</span><span class="p">);</span>
  <span class="n">BindRegistry</span><span class="p">(</span><span class="n">m</span><span class="p">);</span>
<span class="p">}</span>
<span class="p">}</span>  <span class="c1">// namespace cinn::pybind</span>
</pre></div>
</div>
</div>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="../index.html">cinn</a></h1>








<h3>Navigation</h3>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../install.html">Build from source code</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/index.html">Tutorials</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="library_root.html">C++ Symbols</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../index.html">Documentation overview</a><ul>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2020, cinn team.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 3.3.0</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
      |
      <a href="../_sources/cpp/program_listing_file__home_chunwei_project_cinn2_cinn_pybind_ir.cc.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>